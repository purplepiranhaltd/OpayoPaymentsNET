openapi: 3.0.0

info:
  version: 1.0.0
  title: Opayo API Documentation
  description: |
     # Introduction
     
     The Opayo REST API is based on [REST](http://en.wikipedia.org/wiki/Representational_state_transfer) principles. Our resource oriented URLs are only accessible via
     HTTPS and are available in both our test and live environment.
     
     We use [HTTP Authentication](#section/Authentication) and HTTP verbs for each method:
     
     |Verb | Description                    |
     |-----|--------------------------------|
     |GET  | Used for retrieving resources. |
     |POST | Used for creating resources.   |
     
     The Opayo API uses [JSON](http://en.wikipedia.org/wiki/JSON) format for both requests and responses.
     
     We return [HTTP Response Codes](#section/Response-Codes) to indicate the success or failure of an API request, along with further information in the body.
     
     ## Environments
     
     The Test Server is an exact copy of the Live System but without the banks attached. This means you get a true user experience but without the fear of any
     money being taken from your cards during testing.
     
     If you want to test our API without an account you can use one of our [sandbox accounts](#tag/Sandbox-Accounts).
     
     If you would like to test our API with your own credentials you will need a Test Server account to be set up for you by the Opayo Support team. Your test
     account can only be set up once you have submitted an online [Opayo application](https://applications.sagepay.com/apply).
     
     Please ensure that you update your integration to the Live environment API endpoints and credentials before you go live.
     
     ## Getting your API credentials
     
     Before you can start integrating with our REST API you need to get your Integration Key and Password. You can do that by following the guide below:
     
     1. Go to MySagePay in either the [TEST](https://test.sagepay.com/mysagepay) or [LIVE](https://live.sagepay.com/mysagepay) environment and log in using the Administration log
     in details that were provided to you during the setup of the account.
     
     2. Once you are logged in as the Administrator, in the Password details section of the Administrator tab you will see an option to 'Create API credentials'.
     
     3. To create your credentials you just have to select the tick-box labelled 'I understand that this will create new credentials and may break any existing Opayo API implementations.' and click on the 'Create API credentials' button.
     
     4. Once you have opted to create your new credentials we will present you with the following information:
     
       - Environment: This specifies the environment for which the credentials apply (test or live)
       - Vendor Name: The vendor name for the account
       - Integration Key: The value for the Integration key (username)
       - Integration Password: The value for the Integration password
     
     **When you choose to create new credentials, any previously generated credentials are immediately rendered invalid. Therefore, if you have already integrated with our REST API, you will not be able to authenticate your calls until you replace your expired credentials with the ones you just generated.**
     
     Please store these credentials safely. If you lose them, you will need to generate a new set of credentials using the same process.
     
     Please note that these credentials are only valid for our REST API.
     
     # Versioning
     
     The current version of the Opayo API is v1, as defined in the base URL.
     
     To ensure we don't break your code, it's essential that you support the following compatible changes:
     
     * Adding new API resources
     * Adding new optional request parameters.
     * Adding new response properties.
     * Adding additional values to parameters or properties in requests and responses.
     * Changing the length or format of existing fields and resources.
     
     Each time we release a change which isn't backwards compatible (requires you to make a change), we will release a new version of the API.
     
     Of course, we won't suddenly stop supporting older versions but we would advise that to make full use of new benefits, you try to use the latest version.
     
     Read our [API changelog](#tag/API-Changelog) to learn more and keep track of any changes.
     
     
     # Authentication
     Requests to the Opayo API require authentication. We use [HTTP Basic authentication](https://en.wikipedia.org/wiki/Basic_access_authentication) for a simple,
     yet secure method of enforcing access controls.
     
     In order to access our protected resources you must authenticate with our API by providing us with your:
     
     - Integration Key (Username)
     - Integration Password (Password)
     
     How to authenticate:
     
     1. Using HTTP Basic authentication, you will need to combine into a string 'integrationKey:integrationPassword'.
     1. The resulting string will have to be encoded using [Base64](https://en.wikipedia.org/wiki/Base64) encoding.
     1. The encoded string will have to be included in the Authorization header.
     
     _The only exception to the above is the [card identifier](#tag/Card-Identifiers). To create a card identifier you will need to use the Merchant Session Keys as an access token in the
     Authorization request header field._
     
     As the Opayo API is available in our test and live environments, we will provide you with different credentials for both.
     
     Please ensure that you are using the correct credentials for each environment.
     
     **Remember, all requests must be made over HTTPS. This is to ensure that all the sensitive customer information is protected.**
     
     # Response Codes
     
     As much as possible, we attempt to use appropriate HTTP status codes, as well as returning additional details to aid with error handling.
     
     ## HTTP Response Codes
     
     The Opayo API will return appropriate HTTP status codes for every request.
     
     | Code | Text                 | Description
     |------|----------------------|-------------------------------
     | 200  | OK                   | Success! Everything worked as expected.
     | 201  | Created              | Success! Everything worked as expected and a new resource has been created.
     | 202  | Accepted             | The request has been accepted for processing, but the processing has not been completed.
     | 204  | No Content           | The request has been successfully processed and is not returning any content.
     | 400  | Bad Request          | The request could not be understood, generally a malformed body.
     | 401  | Unauthorised         | Authentication credentials are missing or incorrect.
     | 403  | Forbidden            | The request was formed correctly but is unsuccessful. Usually returned when a transaction request is declined or rejected.
     | 404  | Not Found            | The resource does not exist.
     | 405  | Method Not Allowed   | The method requested is not permitted against this resource.
     | 408  | Request              | Timeout  Request timeout.
     | 418  | I'm a teapot         | [https://en.wikipedia.org/wiki/418](https://en.wikipedia.org/wiki/Hyper_Text_Coffee_Pot_Control_Protocol)
     | 422  | Unprocessable Entity | The request was well-formed but contains invalid values or missing properties.
     | 500  | Server Error         | An issue occurred at Opayo.
     | 502  | Bad Gateway          | An issue occurred at Opayo.
     
     ## Opayo Error Codes
     
     As well as returning the HTTP response code, the Opayo API will, when possible, return more detail about the error in the body. This will contain the properties `code` and `description` in JSON format.
     
     When the HTTP response code is `422`, `property` and `clientMessage` fields are also returned, identifying which specific property the error relates to and a user-friendly message. When multiple `422` errors are detected these will be returned in an `errors` array.
     
     Below is a complete list of Opayo errors.
     
     | HTTP   | Code | Description
     |--------|------|-------------
     | `400 ` | 1000 | Incorrect request format
     | `401 ` | 1001 | Authentication values are missing
     | `401 ` | 1002 | Authentication failed
     | `422 ` | 1003 | Missing mandatory field
     | `422 ` | 1004 | Invalid length
     | `422 ` | 1005 | Contains invalid characters
     | `404 ` | 1006 | Merchant Session Keys not found
     | `422 ` | 1007 | The card number has failed our validity checks and is invalid
     | `422 ` | 1008 | The card is not supported
     | `422 ` | 1009 | Contains invalid value
     | `422 ` | 1010 | Currency does not exist
     | `422 ` | 1011 | Merchant Session Keys or card identifier invalid
     | `404 ` | 1012 | Transaction not found
     | `403 ` | 1013 | Transaction type not supported
     | `403 ` | 1014 | Transaction status not applicable
     | `422 ` | 1015 | The request entity was empty
     | `422 ` | 1016 | This parameter requires an integer
     | `403 ` | 1017 | Operation not allowed for this transaction
     | `403 ` | 1018 | This refund amount will exceed the amount of the original transaction
     | `404 ` | 1019 | Transaction instructions not found
     | `422 ` | 1020 | Unable to save a card identifier that is already reusable
     | `403 ` | 1021 | This release amount will exceed the amount of the original transaction
     | `408 ` | 9998 | Request timeout
     | `500 ` | 9999 | An internal error occurred at Opayo
     
     ### Example JSON
     
     ```JSON
     {
        "errors":[
           {
              "code": "1005",
              "property": "cardDetails.cardholderName",
              "description": "Contains invalid characters",
              "clientMessage": "The cardholder name contains invalid characters"
           },
           {
              "code": "1004",
              "property": "cardDetails.cardholderName",
              "description": "Invalid length",
              "clientMessage": "The cardholder name is too long"
           },
           {
              "code": "1003",
              "property": "cardDetails.cardNumber",
              "description": "Missing mandatory field",
              "clientMessage": "The card number is required"
           },
           {
              "code": "1005",
              "property": "cardDetails.expiryDate",
              "description": "Contains invalid characters",
              "clientMessage": "The expiry date has to be in MMYY format"
           }
        ]
     }
     ```
     
     ### Transaction Error Codes
     
     During transaction registration you may receive HTTP 422 errors with a code and description not mentioned in the table above.
     
     To get help with our terminology and those error codes you can visit [our website](https://www.opayo.co.uk/support/error-codes) and type the relevant error code there.




tags:
  - name: Merchant Session Keys
    description: |
      The Merchant Session Keys endpoint allows you to create a `merchantSessionKey`, that you can then use to authenticate your requests.

      Once the Merchant Session Keys is created, it will be used to:

      - Create a card identifier (as `Authorization` bearer token)
      - Submit a transactions registration POST.

      The `merchantSessionKey` expires after 400 seconds and can only be used to create one successful card identifier. It will also expire and be removed after 3 failed attempts to create a card identifier.




  - name: ApplePay Session
    description: |
      The Apple Pay Session endpoint allows you to create an Apple Pay Session, that you can then use to authenticate your Apple Pay transactions. 

      You only need this if you are using the Opayo managed certificate option.




  - name: Card Identifiers
    description: |
      The card identifiers endpoint allows you to represent the card details as the `cardIdentifier` that you will then use in the transaction registration.

      The `cardIdentifier` expires after 400 seconds and is returned on the response along with the expiry and card type. You will need to retrieve the card identifier and use it in the next step to perform a transaction.

  


  - name: Transactions
    description: |
      The transactions endpoint allows you to submit transactions to the Opayo gateway.

      Providing a transaction request is valid, the response may differ depending on the transaction type and the [3D Secure authentication](#tag/3D-Secure) requirements for the transaction.

      ## Transactions without 3D Secure
      When 3D Secure authentication is not required (or is not possible) you will receive a response with HTTP/1.1 201 Created and the transaction object in the body in plain JSON. The transaction object will provide you with the result of the transaction registration via the `status` parameter.

      You must advise of a Strong Customer Authentication (SCA) exemption `threeDSExemptionIndicator` reason if you submit a transaction without 3D Secure. This is an EU mandated requirement that will be enforced by the card schemes. If you do not provide an SCA exemption reason and you do not perform 3D secure authentication, the card issuer will decline your transaction.
      The card issuer will generally decline the transaction with a 'soft decline' `bankResponseCode` value of `65` or `1A`.
      If a 'soft decline' is received, Opayo will automatically submit an authenication request to the card scheme. If the authentication is successful and your rulebase permits, Opayo will submit a new authorisation request to the acquirer with authentication data.

      To be eligible to skip 3D Secure authentication, you must first get permission from your acquirer. They will able to best advise which SCA exemption, if any, suits your business needs.
      If you ask for an exemption, liability for chargebacks is automatically shifted to you (the merchant) and there is a higher chance that the transaction is refused if the card issuer does not agree with the SCA exemption. For this reason, it is advisable to leave the exemption handling down to the card issuer and always submit a 3D Secure authentication request.

      To be able to submit an SCA exemption reason in your transaction request, you must provide the required 3D secure fields and values within the `strongCustomerAuthentication` object. This is incase a 'soft decline' is received and allows Opayo to automatically request for 3D secure authentication.
      For authentication to succeed, correct data must be provided within the `strongCustomerAuthentication` object that relates to your customer.

      ## Transactions with 3D Secure
      When 3D Secure authentication is required you will receive a response with HTTP/1.1 202 Accepted but you will not receive the transaction object in the body. Instead you will receive a set of values in plain JSON that are needed in order to complete the 3D Secure authentication. You will then need to redirect your customer to the `acsUrl` where they have to complete the 3D Secure authentication. For a detailed summary of the 3D Secure authentication process please check our [3D Secure implementation guide.](https://developer-eu.elavon.com/docs/opayo/3d-secure-authentication)

      ## Transaction Types

      Opayo offers you a wide variety of transaction types that you can process through your account with us.

      The Opayo REST API currently supports the following transaction types:

      |type        | description |
      |------------|-------------|
      |Payment     | Payment is the most common transaction type that is processed through our systems. This is when a customer enters their payment details in order to purchase goods or services. This is effectively an Authorisation and Capture in one step. |
      |Deferred    | In some cases you may not wish to take the funds from the card immediately, merely place a ‘shadow' on the customer's card to ensure they cannot subsequently spend those funds elsewhere. Use the ‘Release' instruction when you are ready to ship the goods. |
      |Authenticate| Use this transaction type if you wish to verify the card holder's details, but not reserve any funds on the customer's card. Will need an Authorise transaction to take funds.  |
      |Repeat      | The repeat payment allows you to process another payment whilst using the customer and card details that were captured in a previous transaction. |
      |Refund      | A refund allows you to credit the funds that have already been taken for a transaction back to your customer. You are able to perform partial or full refunds up to the amount of the original transaction. |
      |Authorise   | An Authorise transaction allows you to capture funds from the card. |

      **We may archive transactions that are over 2 years old. We therefore recommend that you check the date of the `Payment` transaction if you have issues performing a secondary transaction such as `Repeat` or `Refund`. If you are performing repeats we recommend that you repeat against the last successful authorised transaction.**



  - name: 3D Secure
    description: |
      The 3D Secure endpoint allows you to provide us with the `cRes` which is the encrypted 3D Secure authentication result. We will then decrypt and use it to provide you with the authentication result and also to complete the transaction authorisation attempt with your acquiring bank.

      For further information regarding the 3D Secure authentication process please check our [overview section](https://developer-eu.elavon.com/docs/opayo/3d-secure-authentication).


  - name: Instructions
    description: |
      In certain cases you might want to provide us with specific instructions for particular transactions.

      **The void instruction type allows you to void a successful transaction up until midnight on the day it is processed. Voiding will cancel the payment and prevent funds being transferred from the customer account. Voids are non-reversible.**

      If you are unable to fulfil the order, the `abort` instruction type allows you to abort a deferred transaction and the customer will never be charged. You can also `cancel` an authenticate transaction.

      Deferred transactions are not sent to the bank for completion until you Release them using the `release` instruction. You can release only once and only for an amount up to and including the amount of the original Deferred transaction.​​​


  - name: Sandbox Accounts
    description: | 
      If you would like to test our REST API but you haven't created your account yet, you can use one of our sandbox accounts in our TEST environment.
      
      ## Basic Profile
      
      The basic profile account has the AVS / CV2 and 3D Secure checks turned off by default. This account is used in most of our code examples.
      
      Basic profile:
      
      ```JSON
      vendorName: sandbox
      integrationKey: hJYxsw7HLbj40cB8udES8CDRFLhuJ8G54O6rDpUXvE6hYDrria
      integrationPassword: o2iHSrFybYMZpmWOQMuhsXP52V4fBtpuSDshrKDSWsBY1OiN6hwd9Kb12z4j5Us5u
      ```
      
      ## Extra Check Profile
      
      The extra checks profile account has strict AVS / CV2 checks and 3D Secure authentication enabled. Any transaction that does not pass either the AVS or CV2 checks will be rejected. The 3D secure checks are turned on and successful transaction registration will result in a request for [3D Secure authentication](#tag/3D-Secure).
      
      Extra checks profile:
      
      ```JSON
      vendorName: sandboxEC
      integrationKey: dq9w6WkkdD2y8k3t4olqu8H6a0vtt3IY7VEsGhAtacbCZ2b5Ud
      integrationPassword: hno3JTEwDHy7hJckU4WuxfeTrjD0N92pIaituQBw5Mtj7RG3V8zOdHCSPKwJ02wAV
      ```
      
      In order for a transaction to pass the AVS checks you will need to provide the following details in the `billingAddress` object:
      
      * `"address1": "88"`
      
      * `"postalCode": "412"`
      
      In order for a transaction to pass the CV2 checks you will have to enter the following security code when creating a card identifier:
      
      * `"securityCode": "123"`
      
      You can always override the default security settings by using the `applyAvsCvcCheck` and `apply3DSecure` properties when posting to the [transactions endpoint](#tag/Transactions).
      
      Example of a transaction that was declined by the security checks:
      
      ```JSON
      {
          "statusCode": "2001",
          "statusDetail": "The Authorisation was Rejected by the vendor rule-base.",
          "transactionId": "759F9DE3-0641-324D-AAF9-825C0608A305",
          "bankResponseCode": "00",
          "status": "Rejected",
          "paymentMethod": {
              "card": {
                  "cardType": "Visa",
                  "lastFourDigits": "0006",
                  "expiryDate": "0320",
                  "cardIdentifier": "cardTokenUUID",
                  "reusable": false
              }
          },
         "amount": {
            "totalAmount": 10000,
            "saleAmount": 10000,
            "surchargeAmount": 0
           },
        "currency" : "GBP",   
        "3DSecure": {
            "status": "NotChecked"
          }
      }
      ```

  - name: Test Card Details
    description: | 
       We have a list of card details that can be used in our test environment and allow for successful transactions to be processed. When you are using any of the cards listed below you will always receive an authorisation code from the test server.
      
       **Please make sure that you do not use your real card details to test your integration.**
      
       | Payment Method	          | Card Number	      | Card Type	        
       |---------------------------|-------------------|-------------------
       | Visa	                    | 4929000000006	    | `Visa`	          
       | Visa	                    | 4929000005559	    | `Visa`	          
       | Visa	                    | 4929000000014	    | `Visa`	          
       | Visa	                    | 4929000000022	    | `Visa`	          
       | Visa Corporate	          | 4484000000002	    | `Visa`	          
       | Visa Debit	              | 4462000000000003	| `VisaDebit`	      
       | Visa Electron	            | 4917300000000008	| `VisaElectron`	  
       | MasterCard	              | 5186150660000009	| `MasterCard`	    
       | MasterCard	              | 5186150660000025	| `MasterCard`	    
       | MasterCard	              | 5186150660000108	| `MasterCard`	    
       | MasterCard	              | 5186150660000207	| `MasterCard`	    
       | Debit MasterCard	        | 5185690060000001	| `DebitMasterCard`	
       | Maestro (UK Issued)	      | 6759000000005	    | `Maestro`	        
       | Maestro (German Issued)	  | 6705000000008	    | `Maestro`	        
       | Maestro (Irish Issued)	  | 5185570760000008	    | `Maestro`	        
       | Maestro (Spanish Issued)	| 6766000000000	    | `Maestro`	        
       | American Express	        | 374200000000004	  | `AmericanExpress`	
       | Diners Club / Discover	  | 36000000000008	  | `Discover`	      
       | JCB	                      | 3569990000000009	| `JCB`	            
      
       * The `securityCode` (CV2/CVV) is always: 123 (1234 for Amex cards)
       * The `billingAddress.address1` is: 88
       * The `billingAddress.postalCode` is: 412
       * Any `expiryDate can` be entered as long as it is in the future
      
       ## Magic CardHolder Values
      
       The following table lists our magic CardHolder values. When you test your Opayo transaction request enter these into the cardholder name field - these simulate 3D-Authenticated transaction responses.
      
       | Cardholder Value	          | 3DSecureStatus                  | Description
       |---------------------------------|---------------------------------|------------------------------
       | SUCCESSFUL                      | OK                              | Returned for a frictionless flow where authentication is successful.
       | NOTAUTH                         | NOTAUTHED                       | Returned for a frictionless flow where authentication is unsuccessful.
       | CHALLENGE                       | Status=3DAUTH, 3DSecureStatus=OK| Returned for a challenge flow. The cardholder will be re-directed to the ACS to enter two-factor authentication. A CReq, VPSTxId, ACSURL and StatusDetail will also be returned. Once you re-direct to the ACSURL, entering the correct password displayed on the site will simulate a successful authentication, entering any other password will simulate an unsuccessful authentication.
       | PROOFATTEMPT                    | ATTEMPTONLY                     | The cardholder attempted to authenticate themselves, and the process did not complete. A CAVV is returned and this is treated as being successfully authenticated.
       | TECHDIFFICULTIES                | INCOMPLETE                      | 3D-Secure authentication was unable to complete. No authentication occurred.
       | ERROR                           | ERROR                           | Simulates an error condition where 3D-Authentication cannot be performed due to data errors or service unavailability in one of the parties involved in the check.
      
      
       Any other phrase will fail the authentication, allowing you to test your rules and 3D Secure response handling.
      
       ## Simulating 'Declined by the bank' response
      
       If you wish to simulate a 'Declined by the bank' response you have to use one of the following card details.
      
       | Payment Method | Card Number      | Card Type
       |----------------|------------------|------------
       | Visa           | 4929602110085639 | `Visa`
       | MasterCard     | 5403814948608092 | `MasterCard`
      
       Example of a response when the transaction has been declined by the bank:
      
       ```JSON
       {
         "statusCode": "2000",
         "statusDetail": "The Authorisation was Declined by the bank.",
         "transactionId": "786D4F71-C1CB-8065-E609-FB29C026BF91",
         "bankResponseCode": "05",
         "status": "NotAuthed",
         "paymentMethod": {
               "card": {
                   "cardType": "Visa",
                   "lastFourDigits": "0006",
                   "expiryDate": "0320",
                   "cardIdentifier": "cardTokenUUID",
                   "reusable": false
               }
           },
          "amount": {
             "totalAmount": 10000,
             "saleAmount": 10000,
             "surchargeAmount": 0
            },
         "currency" : "GBP",
         "3DSecure": {
           "status": "NotChecked"
         }
       }
       ```

  - name: Postman
    description: | 
      If you would like to test the API quickly, we recommend using [Postman](https://www.getpostman.com/apps). To get you started faster, we have created this [collection](https://www.getpostman.com/collections/29db8ae7eb64f8da3c21) that you can simply import into Postman.
      
      Note the following:
      
      * The Postman requests are using the sandbox basic profile (on the right).
      * In the card identifier request, ensure to change the authorisation value in the headers parameter to the merchant session key that is generated.
      * In the transaction request, you will need to add in the merchant session key and card identifier generated as well as change the vendortxcode.

  - name: Checkout reference
    description: | 
      ## Options
      
      | Name                                | Description
      |-------------------------------------|----------------------------------------------------------
      | `merchantSessionKey` <br>  Required | *string:* Unique key that identifies the merchant to the REST API.
      | `containerSelector`                 | *string or function:* The element that will contain the iFrame that will, in turn, contain the hosted payment form. It can either be provided as a String in CSS selector format e.g. `#my-container`, or as a function that returns a DOM element. <br> *Default* `'#sp-container'`
      | `onTokenise`                        | *function:* Specifies a function that will be called when tokenisation is completed. <br> *Argument* `tokenisationResult` is an object that contains three fields `success` (can be `true` or `false`), `cardIdentifier` (the card identifier generated, present only in case of success) and `error` (which is made up of an `httpCode`, an `errorCode` and an `errorMessage`, present only when there was an error)
      
      ```
      sagepayCheckout({ merchantSessionKey: 'DB79BA2D-05DA-5B85-D188-1293D16BBAC8' });
      
      
      sagepayCheckout({
        merchantSessionKey: 'DB79BA2D-05DA-5B85-D188-1293D16BBAC8',
        containerSelector: '#my-container'
      });
      
      
      sagepayCheckout({
        merchantSessionKey: 'DB79BA2D-05DA-5B85-D188-1293D16BBAC8',
        onTokenise: function(tokenisationResult) {
          if (tokenisationResult.success) {
            console.log('Tokenisation successful', tokenisationResult.cardIdentifier);
          } else {
            console.error('Tokenisation failed', tokenisationResult.error.errorMessage);
          }
        }
      });
      ```
      
      ## Methods
      
      | Name       | Description
      |------------|-----------------------------------
      | `form`     | Integrates with an existing form by tokenising on submission and adding a hidden field with the card identifier if tokenisation is successful. The hidden field will contain an [error](#tag/Drop-in-error-handling) when tokenisation fails. Please see errors section for more details. <br> *Optional argument* `formSelector` is a CSS selector or function that selects the form that will submit the resulting `card-identifier` or [errors](#tag/Drop-in-error-handling). If not specified, the container's parent form will be used.
      | `tokenise` | Triggers tokenisation. You can add an optional argument to allow for the tokenisation call to take place when your `merchantSessionKey` has expired or become invalid. <br> *Optional argument* `newMerchantSessionKey`
      | `destroy`  | Removes the iFrame from the container and unregisters any events that may have been registered.
      
      ```
      sagepayCheckout.form();
      sagepayCheckout.form({ formSelector:'[name="checkout-form"]' });
      
      
      sagepayCheckout.tokenise();
      sagepayCheckout.tokenise({ newMerchantSessionKey:'A08FE372-447B-4C10-85DE-D0CCB5D05C90' });
      
      
      sagepayCheckout.destroy();
      ```
      
      ## Basic Flow
      
      In this example the container is nested in a form. The default container ID (`#sp-container`) is used and the form method is invoked to bind to the form.
      
      This is the integration that requires the least amount of code.
      
      Example using defaults (basic flow):
      
      ```
      <form action="/checkout" method="post">
        ...
          <div id="sp-container"></div>
          <script type="text/javascript" src="https://pi-test.sagepay.com/api/v1/js/sagepay.js"></script>
          <script type="text/javascript">
            sagepayCheckout({ merchantSessionKey: 'b9e213be-087d-465e-93c3-ff4a7246cd41' }).form();
          </script>
          ...
      </form>
      ```
      In this example both the container selector and form selector are specified:
      
      ```
      <form id="checkout-form" action="/checkout" method="post">
        ...
      </form>
      <div id="hosted-payments-container"></div>
      <script type="text/javascript" src="https://pi-test.sagepay.com/api/v1/js/sagepay.js"></script>
      <script type="text/javascript">
        sagepayCheckout({
          merchantSessionKey: 'b9e213be-087d-465e-93c3-ff4a7246cd41',
          containerSelector:  '#hosted-payments-container',
        }).form({ formSelector: '#checkout-form' });
      </script>
      ```
      
      ## Custom flow
      
      In this example the card details are tokenised when the ‘tokenise' link is clicked. Successful tokenisation is handled by the custom `mySubmit` function.
      
      Example anchor trigger and custom submission (custom flow):
      
      ```
      ...
      <div id="sp-container"></div>
      <p><a id="my-tokenisation-trigger" href="#">tokenise</a></p>
      <script type="text/javascript" src="https://pi-test.sagepay.com/api/v1/js/sagepay.js"></script>
      <script type="text/javascript">
        const checkout = sagepayCheckout({
          merchantSessionKey: 'b9e213be-087d-465e-93c3-ff4a7246cd41',
          onTokenise: function(tokenisationResult) {
                        if (tokenisationResult.success) {
                          mySubmit(tokenisationResult.cardIdentifier);
                        } else {
                          console.error(tokenisationResult.error.errorMessage);
                        }
                      }
        });
        $('#my-tokenisation-trigger').click(function(e) {
          e.preventDefault();
          checkout.tokenise();
        });
      </script>
      ...
      ```
      
      In this example we bind to the parent form and customise only the way the tokenisation result is handled:
      
      ```
      <form id="checkout-form" method="post">
          ...
          <div id="sp-container"></div>
          <script type="text/javascript" src="https://pi-test.sagepay.com/api/v1/js/sagepay.js"></script>
          <script type="text/javascript">
            function myTokenisationHandler(e) {
              ...
            }
            sagepayCheckout({
              merchantSessionKey: 'b9e213be-087d-465e-93c3-ff4a7246cd41',
              onTokenise: myTokenisationHandler
            }).form({ form: '#checkout-form' });
          </script>
          ...
      </form>
      ```

  - name: API Changelog
    description: | 
      The table logs all major changes to the Opayo REST API in reverse chronological order.
      
      Last Updated: `31-10-2022`
      
      
      | Date       | Version 	| Details
      |------------|----------|--------------------------
      | 31-10-2022 | v1       |       Happy Halloween! Added ApplePay create session and transaction functionality
      | 27-09-2022 | v1       |       Added IPv6 to browserIP field (SCA object)
      | 13-06-2022 | v1       |       Removed references to 3DSv1 in respect of the withdrawal of this functionality
      | 27-06-2022 | v1       |       Added additional decline data to transaction response
      | 12-05-2022 | v1       |       Added SettlementReferenceText field to API
      | 04-03-2022 | v1       |       Added Authenticate / Authorise
      | 05-11-2021 | v1       |	Added Continuous Authority to API
      | 17-05-2021 | v1       |	Updated object names in text (no changes to actual API).
      | 17-03-2021 | v1       |	Updated Mastercard test numbers.
      | 17-03-2021 | v1       |	Changed instances of Sage Pay to Opayo.
      | 17-03-2021 | v1       |	Added missing field lengths.
      | 30-06-2020 | v1       |	Changed `customerPhone` maximum character length from 20 characters to 19 characters and changed the format to `+` and `country code` and `phone number`. Due to card scheme changes for 3D Secure authentication.
      | 30-06-2020 | v1       |	Added `address3` to the `billingAddress` object with a maximum character length of 50 characters. Due to card scheme changes for 3D Secure authentication.
      | 30-06-2020 | v1       |	Changed `address1` and `address2` within the `billingAddress` object to have a maximum character length of 50 characters from 100 characters. Due to card scheme changes for 3D Secure authentication.
      | 30-06-2020 | v1       |	Added `shippingAddress3` to the `shippingDetails` object with a maximum character length of 50 characters. Due to card scheme changes for 3D Secure authentication.
      | 30-06-2020 | v1       |	Changed `shippingAddress1` and `shippingAddress2` within the `shippingDetails` object to have a maximum character length of 50 characters from 100 characters. Due to card scheme changes for 3D Secure authentication.
      | 07-04-2020 | v1       |	Changed `strongCustomerAuthentication` object enum values for child objects from numeric values to alpha values, for transactions requests submitting to the POST transactions endpoint. Child objects changed are: `challengeWindowSize`, `transType`, `threeDSReqAuthMethod`, `threeDSReqPriorAuthMethod`, `chAccAgeInd`, `chAccChangeInd`, `chAccPwChangeInd`, `paymentAccInd`, `shipAddressUsageInd`, `shipNameIndicator`, `suspiciousAccActivity`, `deliveryTimeframe`, `preOrderPurchaseInd`, `reorderItemsInd` and `shipIndicator`.     
      | 07-04-2020 | v1       |	Added `threeDSExemptionIndicator` object, for SCA exemptions, within the `strongCustomerAuthentication` object for transactions requests submitting to the POST transactions endpoint.
      | 07-04-2020 | v1       |	Added `credentialType` object, for Credential on File transactions requests submitting to the POST transactions endpoint.
      | 10-07-2019 | v1       |	Added `strongCustomerAuthentication` object for 3DSv2, `customerMobilePhone` and `customerWorkPhone` fields for transactions requests submitting to the POST transactions endpoint.
      | 08-02-2017 | v1       |	Added `amount` object and `currency` to the transaction response of a POST on transactions endpoint.
      | 20-01-2017 | v1       |	Added `Deferred` transaction type and `abort`\\`release` instructions.
      | 15-09-2016 | v1       |	Added support for reusable `cardIdentifier`.
      | 02-09-2016 | v1       |	Updated the API to use ISO 8601 standards Date Format in all date fields.
      | 15-08-2016 | v1       |	Added support for `Void` instructions. Updated new response codes `1019`.
      | 15-07-2016 | v1       |	Added support for `Refund` transactions. <br> Added amount and currency information to the response for GET requests to the transactions resource. <br> Updated how repeat transactions get created to be aligned with refunds and payments.
      | 12-07-2016 | v1       |	Changed HTTP response code from `402` to `201` for POST requests to the transactions resource when the transaction status is `NotAuthed` or `Rejected` to better reflect that a resource has been created.
      | 09-06-2016 | v1       |	Added payment method object in transaction responses.
      | 16-05-2016 | v1       |	Added support for Repeat transactions.
      | 29-04-2016 | v1       |	Added sandbox section and new test card details.
      | 22-04-2016 | v1       |	Added support for `referrerId` parameter.
      | 21-04-2016 | v1       |	Updated getting started and guides sections to include drop-in checkout.
      | 18-02-2016 | BETA     |	Made `securityCode` optional when tokenising the card details.
      | 15-02-2016 | BETA     |	Added getting your API credentials section. Added `clientMessage` as a property in SagePay Error Codes. Updated test card numbers.
      | 22-01-2016 | BETA     |	Clarified parameters case when posting to ACS url.
      | 12-11-2015 | BETA     |	Added support for transactions with 3D Secure authentication.
      | 29-10-2015 | BETA     |	Used `transactionId` in camelCase instead of `transactionID` in transaction response.
      | 28-10-2015 | BETA     |	Included 3D Secure object in transaction response.
      | 21-08-2015 | BETA     |	Included transactions endpoint.
      | 11-08-2015 | BETA     |	Initial release.

x-tagGroups:
  - name: Resources
    tags:
      - Merchant Session Keys
      - ApplePay Session
      - Card Identifiers
      - Transactions
      - 3D Secure
      - Instructions
  - name: Testing
    tags:
      - Sandbox Accounts
      - Test Card Details

  - name: Checkout
    tags:
      - Checkout reference
  - name: Changelog
    tags:
      - API Changelog

servers:
  - url: https://pi-test.sagepay.com/api/v1
    description: Sandbox server (uses test data, not connected to banks)
  - url: https://pi-live.sagepay.com/api/v1
    description: Production server (uses live data)



paths:

  /merchant-session-keys:
    post:
      tags:
        - Merchant Session Keys
      summary: Create a new Merchant Session Key
      security:
        - BasicAuth: [IntegrationKey:IntegrationPassword]
      description: When you create a `merchantSessionKey` you must specify the Opayo vendor name linked to your API [authentication credentials](#section/Authentication).
      operationId: createMsk
      requestBody:
        description: Request payload
        content:
          application/json:
            schema:
              type: object
              properties:
                vendorName:
                  type: string
                  maxLength: 15
                  example: sandbox
              required:
                - vendorName
      responses:
        '201':
          description: A new `merchantSessionKey` has been successfully created.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MerchantSessionKeys'
        '403':
          description: Authentication error.
  

  /merchant-session-keys/{merchantSessionKey}:
    get:
      tags:
        - Merchant Session Keys
      summary: Check Merchant Session Key validity
      description: Supply the `merchantSessionKey` and we will check its validity and return the `expiry`
      security:
        - BasicAuth: [IntegrationKey:IntegrationPassword]
      parameters:
        - name: merchantSessionKey
          required: true
          in: path
          schema:
            type: string
            
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MerchantSessionKeys'
        '400':
          description: Invalid ID supplied
        '404':
          description: The `merchantSessionKey` was not found
    


  /apple-pay-session:
    post:
      tags:
        - ApplePay Session
      summary: Create an Apple Pay Session
      security:
        - BasicAuth: [IntegrationKey:IntegrationPassword]
      description: When you create an Apple Pay Session you must specify the Opayo vendor name linked to your API [authentication credentials](#section/Authentication).
      operationId: createAPSession
      requestBody:
        description: Request payload
        content:
          application/json:
            schema:
              type: object
              properties:
                vendorName:
                  type: string
                  maxLength: 15
                  example: sandbox
                domain:
                  type: string
                  description: The domain that is registered with Opayo, that the transaction will originate from
                  maxLength: 255
                  example: https://www.example.com
              required:
                - vendorName
                - domain
      responses:
        '201':
          description: A new Apple Pay Session has been successfully created.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplePaySession'
        '403':
          description: Authentication error.
  



  /card-identifiers:
    post:
      tags:
        - Card Identifiers
      summary: Create a new Card Identifier
      security:
        - BearerAuth: [merchantSessionKey]
      description: |
        You need to have a valid `merchantSessionKey` before you can create a `cardIdentifier`.
        
        The merchant session key expires after 400 seconds, after which is no longer be valid. It's also one time use, which means you'll need to generate a new `merchantSessionKey` for every `cardIdentifier`.

        The merchant session key will allow 3 failed attempts to generate a card identifier before it's removed.
      operationId: createCi
      requestBody:
        description: Request payload
        content:
          application/json:
            schema:
              type: object
              properties:
                cardDetails:
                  $ref: '#/components/schemas/cardDetails'              

      responses:
        '201':
          description: A new `cardIdentifier` has been successfully created.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CardIdentifiers'
        '403':
          description: Authentication error.
     
  /card-identifiers/{cardIdentifier}/security-code:
    post:
      tags:
        - Card Identifiers
      summary: Link a Card Identifier
      security:
        - BearerAuth: [merchantSessionKey]

      description: |

        If you are using a reusable card identifier and require a security code check, you will need to link the reusable card identifier with the security code.
      operationId: linkCi
      
      parameters:
        - in: path
          name: cardIdentifier
          required: true
          schema:
            type: string
            format: uuid
            description: The reusable card identifier
      requestBody:
        description: Request payload
        content:
          application/json:
            schema:
              type: object
              properties:
                securityCode:
                  type: string
                  maxLength: 4
                  minLength: 3
                  description: The card security code, also known as CV2, CVV or CVC, this is used in CV2 checks.
                  example: 123
              required:
                - securityCode
      responses:
        '204':
          description: The `cardIdentifier` has been successfully linked to the security code.
        '403':
          description: Authentication error.
    
  /card-identifiers/{cardIdentifier}:
    delete:
      tags:
        - Card Identifiers
      summary: Remove Card Identifier
      description: Supply the `cardIdentifier` and we will remove it from our system
      security:
        - BasicAuth: [IntegrationKey:IntegrationPassword]
      parameters:
        - name: cardIdentifier
          required: true
          in: path
          schema:
            type: string
            
      responses:
        '200':
          description: Successful operation

        '400':
          description: Invalid cardIdentifier supplied
        '404':
          description: The `cardIdentifier` was not found
    


  /transactions:
    post:
      tags:
        - Transactions

      security:
        - BasicAuth: [IntegrationKey:IntegrationPassword]
  
      summary: Create a Transaction
      description: |
        There are different request objects that can be sent, depending on the transaction type or payment method:

      operationId: createTransaction
      requestBody:
        description: Request payload
        content:
          application/json:
            schema:
              oneOf:
                - $ref: '#/components/schemas/Payment'
                - $ref: '#/components/schemas/Deferred'
                - $ref: '#/components/schemas/Authenticate'   
                - $ref: '#/components/schemas/Refund'               
                - $ref: '#/components/schemas/Repeat'
                - $ref: '#/components/schemas/Authorise'     

      responses:
        '202':
          description: You will need to forward your customer according to the payment method or whether SCA is required
          content:
            application/json:
              schema:
                oneOf:
#                  - $ref: '#/components/schemas/PayPal'
                  - $ref: '#/components/schemas/3DSv2'                 
        '201':
          description: A new `transaction` has been created.
          content:
            application/json:
              schema:
                oneOf:
                  - $ref: '#/components/schemas/Card'   
#                  - $ref: '#/components/schemas/Paypal'   
                  - $ref: '#/components/schemas/Applepay'   
  /transactions/{transactionId}:
    get:
      tags:
        - Transactions
      summary: Retrieve a Transaction
      security:
        - BasicAuth: [IntegrationKey:IntegrationPassword]
      description: Supply a valid `transactionId` and we will provide you with the transaction object.
      operationId: retrieveTransaction
      parameters:
        - in: path
          name: transactionId
          required: true
          schema:
            type: string
            description: Opayo's unique reference for this transaction.
      responses:
        '200':
          description: The `transaction` was retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  transactionId:
                    type: string
                    description: Opayo's unique reference for this transaction.
                    example: DB79BA2D-05DA-5B85-D188-1293D16BBAC7
                  transactionType:
                    type: string
                    description: The type of the transaction
                    enum:
                      - Payment
                      - Deferred
                      - Repeat
                      - Refund
                  status:
                    type: string
                    enum:
                      - Ok
                      - NotAuthed
                      - Rejected
                      - Malformed
                      - Invalid
                      - Error
                    description: >
                      Result of transaction registration.
                       * `Ok Transaction` - request completed successfully.
                       * `NotAuthed` - Transaction request was not authorised by the bank.
                       * `Rejected` - Transaction rejected by your fraud rules.
                       * `Malformed` - Missing properties or badly formed body.
                       * `Invalid` - Invalid property values supplied.
                       * `Error` - An error occurred at Sage Pay.
                  statusCode:
                    type: string
                    description: |
                      Code related to the `status` of the transaction.
                      *Successfully authorised transactions will have the `statusCode` of `0000`. You can lookup any other status code on our [website](https://www.sagepay.co.uk/support/error-codes).*
                    example: 0000
                  statusDetail:
                    type: string
                    description: A detailed reason for the `status` of the transaction.
                    example: The Authorisation was Successful.
                  retrievalReference:
                    type: string
                    description: Opayo's unique Authorisation Code for a successfully authorised transaction. Only present if `status` is `Ok`.
                    example: 9493946
                  bankResponseCode:
                    type: string
                    description: |
                      Also known as the decline code, these are codes that are specific to your merchant bank. Please contact them for a description of each code.
                      *This is only returned for transaction type `Payment`*
                    example: 00
                  bankAuthorisationCode:
                    type: string
                    description: The authorisation code returned from your merchant bank.
                    example: 999777
                  amount:
                    description: Provides information regarding the transaction amount.
                      *This is only returned in GET requests*
                    $ref: '#/components/schemas/amount'
                  avsCvcCheck:
                    description: Provides information regarding the AVS/CV2 check results.
                      *This is only returned for Payment and Deferred* transactions.
                    $ref: '#/components/schemas/avsCvcCheck'
                  currency:
                    type: string
                    minLength: 3
                    maxLength: 3
                    description: The currency of the `amount` in 3 letter [ISO 4217 format](http://en.wikipedia.org/wiki/ISO_4217).
                      *This is only returned in GET requests*
                    example: GBP
                  paymentMethod:
                    type: object
                    description: The `paymentMethod` object specifies the payment method for the transaction.
                    properties:
                      card:
                        type: object
                        description: The `card` object represents the credit or debit card details for this transaction.
                        properties:
                          cardType:
                            type: string
                            description: The type of the card used for the transaction.
                            example: Visa
                          lastFourDigits:
                            type: string
                            description: The last 4 digits of the card number used for the transaction.
                            example: Visa
                          expiry:
                            type: string
                            description: The expiry date of the card used for the transaction.
                            example: Visa
                          cardIdentifier:
                            type: string
                            format: uuid
                            description: The unique reference of the card you want to charge.
                            example: 7F3CCA38-0BDA-453B-BF62-9CBD5891F77E
                          reusable:
                            type: boolean
                            description: A flag to indicate the card identifier is reusable, i.e. it has been created previously.
                            default: false

                  3DSecure:
                    description: Provides the 3D Secure status of the transaction, if applied.
                    $ref: '#/components/schemas/3DSecure'
 


   
  /transactions/{transactionId}/3d-secure-challenge:
    post:
      tags:
        - 3D Secure
      summary: Create a 3D Secure challenge response (3DSv2)
      security:
        - BasicAuth: [IntegrationKey:IntegrationPassword]
      description: |
        We will create and return the 3D Secure object (containing the 3D result) within the transaction object.
        

        **Please note that the `cRes` for a transaction has to be provided within 20 minutes from our initial response.**

      operationId: create3DSecurev2
      parameters:
        - in: path
          name: transactionId
          required: true
          schema:
            type: string
            format: uuid
            description: Opayo's unique reference for this transaction.
      requestBody:
        description: Request payload
        content:
          application/json:
            schema:
              type: object
              properties:
                cRes:
                  description: >
                    A Base64 encoded, encrypted message sent back by Issuing Bank to your Terminal URL at the end of the 3D-Authentication process.

                    You will receive this value back from the Issuing Bank in a field called cres (lower case `cr`), but should be passed to Opayo as `cRes`.

                  type: string
                  example: eJylV1tzqkgQfvdXpNxHKuEioKSIW8NFhAgCIipvBAcEERAQ0F+/aEzMyZ7d2rhUUdJtX76vp3sG2D+bXfxQwbwI0+Sliz9h3QeYeOk6TIKX7twaPQ66fw47rLXJIRRm0DvkcMiqsCjcAD6E65cugeEkSQ8wiuwxGNHHu0NWByYsLn9mbg6LZ+yJYaj+gKIGPYYc9Frb1uiac9imfMJZ9ENsY+fexk3KIet6e07WhiRDMBjGoleR3cFcFoY40YYjBgyLvsssenPUD+enogXahOuhkjN9Pa34hMCPgAqaZrQfh7uVECH1C4ueLdi1W8JhS4TCcYx+wLFnovdMtaEvejY7hwO79NDGxlsgX2W2LUjeFuw4HBA0i35KLGyyNIGtBcGin88seoOWucmV2vvVep9VrLUcsmW4+xVPD3/G+yx60bNF6ZaHYrhi0esT67lVNQQAcMA0qW0Nvl8tz4sJC71wiFEtovb34gXiIM3DcrM74/xVwaJnKOhlMdsSFc+zMEjafDl8aHsmKZ7XxUt3U5bZM4rWdf1U957SPECJlguKMWhrsy7C4I9u2z1XZ7iWEz+9x5t3kzQJPTcOT27ZtokKy026fvgE+7tQlnmOhqOmyD+24R49nEwezxqsh1Pdn6FAbyQuFfgv+b8HyQv3sdi4+H2pTejDc2vBh7kpv3R/GOQ9hpW7SeGn+a74X94/ow2TCsZpBtePxUf17qvAf8z/r8v+x6J149Pdrp3G4g4Y6C9VfMclhAEsyns64v5ueM9pu/Hhp8Po9Rm8MAwJGb9WmdPbYFlivOpYVu3Ilwu9L6GvhD9b7yrfRvnbVNyDp+O7h52iRINmsDDX1siQMKOitTEI7NqNS4mmhXDQZPN8V2Oq/4bFB0WndyLl9v0tR0oyPcKdCWT2vT7hhh3PEwtq76JYJUl7hIHgpGexjc1xS+IgiBtfCQ+yGlmDDNfM0HkVhR0lRpUyxQLSXc2qus6W64rAyfhEdHRGOyXC6qTjO7+MbWWFky+3CtwYv1fhFR7v3d2WFMYIbune68vDvAz9dnssf1x9VZZ5zeJ54NABqGUOAFk0wNxxIqBxwXa/2YYSU2McMOYjIHC+ahQ1b6wEu20hsVbs2UnUVYBJAJ+LHZ5TJUtiDk57fzEct4Yj2xKnKqgvhvxGHc3HSrUeB40YAYMLNJsDhcXb3PGtZ5KyiBud2RcH0Hw61OONp6mCUauWiKkWOGqRQSzOupNYa1Fr+aGLbmg7v4N7L9rO7+D+E9rAGdSCsVJeU0feVJ4GDJHjDCAEKwyosqR0QCpx4LWF5CWELmHOdmOJJE/QFh17M8xaT8jpSJ97ES26LiVoajAf487Si5YpclxNbEpBw71tb72gmBmdPC3oEMdzLZF6/gbRk+kibYpdYASUa3kkatERkjuQ95I3Z7wFr9VoChyDiHs4crAXadBMKL10ZW9JVJtO0NN525VTEAm9KY00SDiwZ40cg0Bt20T8Tmv0TksEUdIr+dm0dyD0SK9neZBtZ53j1BOker8Oj3VoaxliVttjeQC9fL4n7cSBdoiTxgFr0BMqIvONyHARHVlzaG6ILcNUg6PP7T1+cVjFA6cDRpJoWf4SQMetimmgFNMij5pYQxBfPtJJf3oKRAJoZb6hZ9LbQmiSUDGFKhuN2oa2QnqbyyfaVytavA70tyka3rTnufwc8Ls2uMvpPQP/x11N14f48ONTOxUM5+ivBm/mbjZSrWDylul7u5mYGlYF5Jwxj3pqZvlWxY6c4dvx+qjBqK8E5XKbIK+ZvTCPfKPwh/C0n3SWi4Lw3tbImEQ8yo2ko8vxQpxpp4jR9zpdxqRyXJdbaID9YE5yseAu/SVN2W4oiNUWwdNN47uIJHgDxe6kYcCrutfP+2N60tgTMZxfV+JK9Z23eH1x/iFxYADuEuzD/+Mgu63CVfN38Xqs/bLLXz4uLl8855fir19CfwGvWEqk
              required:
                - cRes
      responses:
        '201':
          description: A new `transaction` has been created with 3D Secure.
          content:
            application/json:
              schema:
                type: object
                $ref: '#/components/schemas/Card'


  /transactions/{transactionId}/instructions:
    post:
      tags:
        - Instructions
      security:
        - BasicAuth: [IntegrationKey:IntegrationPassword]  
      summary: Create an Instruction
      description: |
        When you create an instruction you need to specify the instruction type you want to apply. E.g. to void a transaction you need to specify the `instructionType` as `void`.

      operationId: createInstruction
      parameters:
        - in: path
          name: transactionId
          required: true
      requestBody:
        description: Request payload
        content:
          application/json:      
            schema:
              oneOf:
                - $ref: '#/components/schemas/void'
                - $ref: '#/components/schemas/abort'
                - $ref: '#/components/schemas/release'               
                - $ref: '#/components/schemas/cancel'       
      
      responses:
        '201':
          description: A new `instruction` object has been created
          content:
            application/json:
              schema:
                type: object
                properties:
                  instructionType:
                    type: string
                    description: The type of the instruction.
                    enum:
                      - void
                      - abort
                      - release
                      - cancel
                  date:
                    type: string
                    description: Date/Time field is in [ISO 8601](http://en.wikipedia.org/wiki/ISO_8601#Combined_date_and_time_representations) format.
                    example: 2018-31-05T10:30
      
    

components:


  securitySchemes:
    BasicAuth:
      type: http
      scheme: basic
    BearerAuth:
      type: http
      scheme: bearer  

  schemas:
    void:
      type: object
      properties:
        instructionType:
          description: The type of the instruction
          type: string
          example: void
          enum:
            - void
    abort:
      type: object
      properties:
        instructionType:
          description: The type of the instruction
          type: string
          example: abort
          enum:
            - abort
    cancel:
      type: object
      properties:
        instructionType:
          description: The type of the instruction
          type: string
          example: cancel
          enum:
            - cancel
    release:
      type: object
      properties:
        instructionType:
          description: The type of the instruction
          type: string
          example: release
          enum:
            - release
        amount:
          type: integer
          description: The amount property is compulsory for a 'release' instruction after a 'Deferred' transaction. The amount charged to the customer in the smallest currency unit. (e.g 100 pence to charge £1.00, or 1 to charge ¥1 (0-decimal currency).
          example: 567  
   
    Repeat:
      type: object
      properties:
        transactionType:
          description: The type of the transaction
          type: string
          example: Repeat
          enum:
            - Repeat
        referenceTransactionId:
          type: string
          description: The `transactionId` of the referenced transaction.
          example: 6a57c703-72bf-429e-96ed-c1db37bc76e0
        vendorTxCode:
          type: string
          description: Your unique reference for this transaction.
          maxLength: 40
          example: demotransaction-<unique-suffix>
        amount:
          type: integer
          description: The amount charged to the customer in the smallest currency unit. (e.g 100 pence to charge £1.00, or 1 to charge ¥1 (0-decimal currency).
          example: 567
        currency:
          type: string
          maxLength: 3
          minLength: 3
          description: The currency of the amount in 3 letter [ISO 4217](https://en.wikipedia.org/wiki/ISO_4217) format.
          example: GBP
        description:
          type: string
          maxLength: 40
          description: A brief description of the goods or services purchased.
          example: Demo Repeat transaction
        shippingDetails:
          $ref: '#/components/schemas/shippingDetails'
        giftAid:
          type: boolean
          description: Identifies the customer has ticked a box to indicate that they wish to receive tax back on their donation.
          default: false
        credentialType:
          $ref: '#/components/schemas/credentialTypeRepeat'
          required:
            - transactionType
            - referenceTransactionId
            - vendorTxCode
            - amount
            - currency
            - description
            - credentialType   
    Refund:
      type: object
      properties:
        transactionType:
          description: The type of the transaction
          type: string
          example: Refund
          enum:
                        - Refund
        referenceTransactionId:
          type: string
          description: The `transactionId` of the referenced transaction.
          example: 6a57c703-72bf-429e-96ed-c1db37bc76e0
        vendorTxCode:
          type: string
          description: Your unique reference for this transaction.
          maxLength: 40
          example: demotransaction99
        amount:
          type: integer
          description: The amount refunded to the customer in the smallest currency unit. (e.g 100 pence to refund £1.00, or 1 to refund ¥1 (0-decimal currency).
          example: 4
        description:
          type: string
          description: A brief description of the reason for the refund
          example: Demo Refund
          required:
                    - transactionType
                    - referenceTransactionId
                    - vendorTxCode
                    - amount
                    - description


    Payment:
      type: object    
      properties:
        transactionType:
          description: The type of the transaction
          type: string
          example: Payment
          enum:
                        - Payment
                        
        paymentMethod:
          type: object
          description: The `paymentMethod` object specifies the payment method for the transaction. You should only supply one of the objects below
          properties:
            card:
              $ref: '#/components/schemas/card'
#            paypal:
#              $ref: '#/components/schemas/paypal'
            applepay:
              $ref: '#/components/schemas/applepay'
        vendorTxCode:
          type: string
          description: Your unique reference for this transaction.
          maxLength: 40
          example: demotransaction-<unique-suffix>
        amount:
          type: integer
          description: The amount charged to the customer in the smallest currency unit. (e.g 100 pence to charge £1.00, or 1 to charge ¥1 (0-decimal currency).
          example: 1000
        currency:
          type: string
          maxLength: 3
          minLength: 3
          description: The currency of the amount in 3 letter [ISO 4217](https://en.wikipedia.org/wiki/ISO_4217) format.
          example: GBP
        description:
          type: string
          maxLength: 100
          description: A brief description of the goods or services purchased.
          example: Demo Payment
        settlementReferenceText:
          type: string
          maxLength: 30
          description: A unique reference that you may wish to be displayed on your acquirer's settlement report (Not enabled for all acquirers. Please contact support for supported acquirers).
          example: 123456GRTY234
        customerFirstName:
          type: string
          maxLength: 20
          description: Customer's first names.
          example: Sam
        customerLastName:
          type: string
          maxLength: 20
          description: Customer's last name.
          example: Jones
        billingAddress:
          $ref: '#/components/schemas/billingAddress'
        entryMethod:
          type: string
          description: The method used to capture card data.
          enum:
                        - Ecommerce
                        - MailOrder
                        - TelephoneOrder
                        - ContinuousAuthority
          default: Ecommerce
        giftAid:
          type: boolean
          description: Identifies the customer has ticked a box to indicate that they wish to receive tax back on their donation.
          default: false
        apply3DSecure:
          type: string
          enum:
                        - UseMSPSetting
                        - Force
                        - Disable
                        - ForceIgnoringRules
          description: >
                        Use this field to override your default account level 3D Secure settings
                         * `UseMSPSetting` - Use default MySagePay settings.
                         * `Force` - Apply authentication even if turned off.
                         * `Disable` - Only use this if you intend to use an SCA Exemption. See [here](https://developer-eu.elavon.com/docs/opayo/3d-secure-authentication/sca-exemptions) for more information.
                         * `ForceIgnoringRules` - Apply authentication but ignore rules.
        applyAvsCvcCheck:
          type: string
          enum:
                        - UseMSPSetting
                        - Force
                        - Disable
                        - ForceIgnoringRules
          description: >
                        Use this field to override your default account level AVS CVC settings.
                         * `UseMSPSetting` - Use default MySagePay settings.
                         * `Force` - Apply authentication even if turned off.
                         * `Disable` - Disable authentication and rules.
                         * `ForceIgnoringRules` - Apply authentication but ignore rules.
        customerEmail:
          type: string
          maxLength: 80
          description: Customer's email address.
          example: sam.jones@example.com
        customerPhone:
          type: string
          description: >
                        Customer's home phone number (this could also be the same as their mobile phone number if they do not have a home phone).

                        The customerPhone must be in the format of `+` and `country code` and `phone number`.

                        Example: For a UK phone number of `03069 990210`, you will submit the following: `+443069990210`.

                        When using the `strongCustomerAuthentication` object, it is advisable to provide this data if the cardholder has it. This will assist the card issuer when determining the 3D Secure authentication result.
          example: "+443069990210"
          maxLength: 19
        shippingDetails:
          default: Defaults to billingAddress object property values if not supplied.
          $ref: '#/components/schemas/shippingDetails'
        referrerId:
          type: string
          description: This can be used to send the unique reference for the partner that referred the merchant to Opayo.
          maxLength: 40
          example: f9979593-a390-4069-b126-7914783fc039
        strongCustomerAuthentication:
          $ref: '#/components/schemas/strongCustomerAuthentication'
        customerMobilePhone:
          type: string
          description: >
                        The mobile number of the customer.

                          The customerMobilePhone must be in the format of `+` and `country code` and `phone number`.

                          Example: For a UK phone number of `07234 567891`, you will submit the following: `+447234567891`

                          When using the `strongCustomerAuthentication` object, it is advisable to provide this data if the cardholder has it. This will assist the card issuer when determining the 3D Secure authentication result.
          example: "+447234567891"
          maxLength: 19
        customerWorkPhone:
          type: string
          description: >
                        The work phone number of the customer.

                          The customerWorkPhone must be in the format of `+` and `country code` and `phone number`.

                          Example: For a UK phone number of `01234 567891`, you will submit the following: `+441234567891`

                          When using the `strongCustomerAuthentication` object, it is advisable to provide this data if the cardholder has it. This will assist the card issuer when determining the 3D Secure authentication result.
          example: "+441234567891"
          maxLength: 19
        credentialType:
          $ref: '#/components/schemas/credentialType'
        fiRecipient:
          $ref: '#/components/schemas/fiRecipient'
          required:
                    - transactionType
                    - paymentMethod
                    - vendorTxCode
                    - amount
                    - currency
                    - description
                    - customerFirstName
                    - customerLastName
                    - billingAddress
    Authenticate:
      type: object    
      properties:
        transactionType:
          description: The type of the transaction
          type: string
          example: Authenticate
          enum:
                        - Authenticate
                        
        
        paymentMethod:
          $ref: '#/components/schemas/paymentMethod'
        vendorTxCode:
          type: string
          description: Your unique reference for this transaction.
          maxLength: 40
          example: demotransaction-<unique-suffix>
        amount:
          type: integer
          description:  The amount that you envisage being charged to the customer in the smallest currency unit. (e.g 100 pence to charge £1.00, or 1 to charge ¥1 (0-decimal currency). A zero value authorisation will occur automatically behind the scenes, no shadow will show on the cardholders account, the authentication and zero authorisation result will be returned in the response. No amount will be charged to the customer card until you issue a specific Authorise request. If you submit 0 as the amount, a zero value authorisation will also occur automatically behind the scenes, and you will be able to capture a token (as long as the "save" flag is set to true), for future merchant inititated transactions (MIT). See [here](https://developer-eu.elavon.com/docs/opayo/compliance/zero-value-authorisation) for more information.
          example: 1000
        currency:
          type: string
          maxLength: 3
          minLength: 3
          description: The currency of the amount in 3 letter [ISO 4217](https://en.wikipedia.org/wiki/ISO_4217) format.
          example: GBP
        settlementReferenceText:
          type: string
          maxLength: 30
          description: A unique reference that you may wish to be displayed on your acquirer's settlement report (Not enabled for all acquirers. Please contact support for supported acquirers).
          example: 123456GRTY234
        description:
          type: string
          maxLength: 100
          description: A brief description of the goods or services purchased.
          example: Demo Authenticate
        customerFirstName:
          type: string
          maxLength: 20
          description: Customer's first names.
          example: Sam
        customerLastName:
          type: string
          maxLength: 20
          description: Customer's last name.
          example: Jones
        billingAddress:
          $ref: '#/components/schemas/billingAddress'
        entryMethod:
          type: string
          description: The method used to capture card data.
          enum:
                        - Ecommerce
                        - MailOrder
                        - TelephoneOrder
                        - ContinuousAuthority
          default: Ecommerce
        giftAid:
          type: boolean
          description: Identifies the customer has ticked a box to indicate that they wish to receive tax back on their donation.
          default: false
        apply3DSecure:
          type: string
          enum:
                        - UseMSPSetting
                        - Force
                        - Disable
                        - ForceIgnoringRules
          description: >
                        Use this field to override your default account level 3D Secure settings
                         * `UseMSPSetting` - Use default MySagePay settings.
                         * `Force` - Apply authentication even if turned off.
                         * `Disable` - Only use this if you intend to use an SCA Exemption. See [here](https://developer-eu.elavon.com/docs/opayo/3d-secure-authentication/sca-exemptions) for more information.
                         * `ForceIgnoringRules` - Apply authentication but ignore rules.
        applyAvsCvcCheck:
          type: string
          enum:
                        - UseMSPSetting
                        - Force
                        - Disable
                        - ForceIgnoringRules
          description: >
                        Use this field to override your default account level AVS CVC settings.
                         * `UseMSPSetting` - Use default MySagePay settings.
                         * `Force` - Apply authentication even if turned off.
                         * `Disable` - Disable authentication and rules.
                         * `ForceIgnoringRules` - Apply authentication but ignore rules.
        customerEmail:
          type: string
          maxLength: 80
          description: Customer's email address.
          example: sam.jones@example.com
        customerPhone:
          type: string
          description: >
                        Customer's home phone number (this could also be the same as their mobile phone number if they do not have a home phone).

                        The customerPhone must be in the format of `+` and `country code` and `phone number`.

                        Example: For a UK phone number of `03069 990210`, you will submit the following: `+443069990210`.

                        When using the `strongCustomerAuthentication` object, it is advisable to provide this data if the cardholder has it. This will assist the card issuer when determining the 3D Secure authentication result.
          example: "+443069990210"
          maxLength: 19
        shippingDetails:
          default: Defaults to billingAddress object property values if not supplied.
          $ref: '#/components/schemas/shippingDetails'
        referrerId:
          type: string
          description: This can be used to send the unique reference for the partner that referred the merchant to Opayo.
          maxLength: 40
          example: f9979593-a390-4069-b126-7914783fc039
        strongCustomerAuthentication:
          $ref: '#/components/schemas/strongCustomerAuthentication'
        customerMobilePhone:
          type: string
          description: >
                        The mobile number of the customer.

                          The customerMobilePhone must be in the format of `+` and `country code` and `phone number`.

                          Example: For a UK phone number of `07234 567891`, you will submit the following: `+447234567891`

                          When using the `strongCustomerAuthentication` object, it is advisable to provide this data if the cardholder has it. This will assist the card issuer when determining the 3D Secure authentication result.
          example: "+447234567891"
          maxLength: 19
        customerWorkPhone:
          type: string
          description: >
                        The work phone number of the customer.

                          The customerWorkPhone must be in the format of `+` and `country code` and `phone number`.

                          Example: For a UK phone number of `01234 567891`, you will submit the following: `+441234567891`

                          When using the `strongCustomerAuthentication` object, it is advisable to provide this data if the cardholder has it. This will assist the card issuer when determining the 3D Secure authentication result.
          example: "+441234567891"
          maxLength: 19
        credentialType:
          $ref: '#/components/schemas/credentialType'
        fiRecipient:
          $ref: '#/components/schemas/fiRecipient'
          required:
                    - transactionType
                    - paymentMethod
                    - vendorTxCode
                    - amount
                    - currency
                    - description
                    - customerFirstName
                    - customerLastName
                    - billingAddress
    Authorise:
      type: object    
      properties:
        transactionType:
          description: The type of the transaction
          type: string
          example: Authorise
          enum:
                        
                        - Authorise
       
        referenceTransactionId:
          type: string
          description: The `transactionId` of the referenced transaction.
          example: 6a57c703-72bf-429e-96ed-c1db37bc76e0
        vendorTxCode:
          type: string
          description: Your unique reference for this transaction.
          maxLength: 40
          example: demotransaction-<unique-suffix>
        amount:
          type: integer
          description: The amount charged to the customer in the smallest currency unit. (e.g 100 pence to charge £1.00, or 1 to charge ¥1 (0-decimal currency).
          example: 1000
        
        description:
          type: string
          maxLength: 100
          description: A brief description of the goods or services purchased.
          example: Demo Authorise
      
        applyAvsCvcCheck:
          type: string
          enum:
                        - UseMSPSetting
                        - Force
                        - Disable
                        - ForceIgnoringRules
          description: >
                        Use this field to override your default account level AVS CVC settings.
                         * `UseMSPSetting` - Use default MySagePay settings.
                         * `Force` - Apply authentication even if turned off.
                         * `Disable` - Disable authentication and rules.
                         * `ForceIgnoringRules` - Apply authentication but ignore rules.
        cv2:
          type: string
          maxLength: 4
          minLength: 3
          description: The card security code, also known as CV2, CVV, or CVC. This is used in CV2 checks.
          example: '123'
    Deferred:
      type: object    
      properties:
        transactionType:
          description: The type of the transaction
          type: string
          example: Deferred
          enum:
                        
                        - Deferred
        paymentMethod:
          $ref: '#/components/schemas/paymentMethod'
        vendorTxCode:
          type: string
          description: Your unique reference for this transaction.
          maxLength: 40
          example: demotransaction-<unique-suffix>
        amount:
          type: integer
          description: The amount charged to the customer in the smallest currency unit. (e.g 100 pence to charge £1.00, or 1 to charge ¥1 (0-decimal currency).
          example: 1000
        currency:
          type: string
          maxLength: 3
          minLength: 3
          description: The currency of the amount in 3 letter [ISO 4217](https://en.wikipedia.org/wiki/ISO_4217) format.
          example: GBP
        settlementReferenceText:
          type: string
          maxLength: 30
          description: A unique reference that you may wish to be displayed on your acquirer's settlement report (Not enabled for all acquirers. Please contact support for supported acquirers).
          example: 123456GRTY234

        description:
          type: string
          maxLength: 100
          description: A brief description of the goods or services purchased.
          example: Demo Deferred
        customerFirstName:
          type: string
          maxLength: 20
          description: Customer's first names.
          example: Sam
        customerLastName:
          type: string
          maxLength: 20
          description: Customer's last name.
          example: Jones
        billingAddress:
          $ref: '#/components/schemas/billingAddress'
        entryMethod:
          type: string
          description: The method used to capture card data.
          enum:
                        - Ecommerce
                        - MailOrder
                        - TelephoneOrder
                        - ContinuousAuthority
          default: Ecommerce
        giftAid:
          type: boolean
          description: Identifies the customer has ticked a box to indicate that they wish to receive tax back on their donation.
          default: false
        apply3DSecure:
          type: string
          enum:
                        - UseMSPSetting
                        - Force
                        - Disable
                        - ForceIgnoringRules
          description: >
                        Use this field to override your default account level 3D Secure settings
                         * `UseMSPSetting` - Use default MySagePay settings.
                         * `Force` - Apply authentication even if turned off.
                         * `Disable` - Only use this if you intend to use an SCA Exemption. See [here](https://developer-eu.elavon.com/docs/opayo/3d-secure-authentication/sca-exemptions) for more information.
                         * `ForceIgnoringRules` - Apply authentication but ignore rules.
        applyAvsCvcCheck:
          type: string
          enum:
                        - UseMSPSetting
                        - Force
                        - Disable
                        - ForceIgnoringRules
          description: >
                        Use this field to override your default account level AVS CVC settings.
                         * `UseMSPSetting` - Use default MySagePay settings.
                         * `Force` - Apply authentication even if turned off.
                         * `Disable` - Disable authentication and rules.
                         * `ForceIgnoringRules` - Apply authentication but ignore rules.
        customerEmail:
          type: string
          maxLength: 80
          description: Customer's email address.
          example: sam.jones@example.com
        customerPhone:
          type: string
          description: >
                        Customer's home phone number (this could also be the same as their mobile phone number if they do not have a home phone).

                        The customerPhone must be in the format of `+` and `country code` and `phone number`.

                        Example: For a UK phone number of `03069 990210`, you will submit the following: `+443069990210`.

                        When using the `strongCustomerAuthentication` object, it is advisable to provide this data if the cardholder has it. This will assist the card issuer when determining the 3D Secure authentication result.
          example: "+443069990210"
          maxLength: 19
        shippingDetails:
          default: Defaults to billingAddress object property values if not supplied.
          $ref: '#/components/schemas/shippingDetails'
        referrerId:
          type: string
          description: This can be used to send the unique reference for the partner that referred the merchant to Opayo.
          maxLength: 40
          example: f9979593-a390-4069-b126-7914783fc039
        strongCustomerAuthentication:
          $ref: '#/components/schemas/strongCustomerAuthentication'
        customerMobilePhone:
          type: string
          description: >
                        The mobile number of the customer.

                          The customerMobilePhone must be in the format of `+` and `country code` and `phone number`.

                          Example: For a UK phone number of `07234 567891`, you will submit the following: `+447234567891`

                          When using the `strongCustomerAuthentication` object, it is advisable to provide this data if the cardholder has it. This will assist the card issuer when determining the 3D Secure authentication result.
          example: "+447234567891"
          maxLength: 19
        customerWorkPhone:
          type: string
          description: >
                        The work phone number of the customer.

                          The customerWorkPhone must be in the format of `+` and `country code` and `phone number`.

                          Example: For a UK phone number of `01234 567891`, you will submit the following: `+441234567891`

                          When using the `strongCustomerAuthentication` object, it is advisable to provide this data if the cardholder has it. This will assist the card issuer when determining the 3D Secure authentication result.
          example: "+441234567891"
          maxLength: 19
        credentialType:
          $ref: '#/components/schemas/credentialType'
        fiRecipient:
          $ref: '#/components/schemas/fiRecipient'
          required:
                    - transactionType
                    - paymentMethod
                    - vendorTxCode
                    - amount
                    - currency
                    - description
                    - customerFirstName
                    - customerLastName
                    - billingAddress
    MerchantSessionKeys:
      type: object
      properties:
        merchantSessionKey:
          type: string
          example: M1E996F5-A9BC-41FE-B088-E5B73DB94277
        expiry:
          type: string
          description: Date/Time in [ISO 8601](http://en.wikipedia.org/wiki/ISO_8601#Combined_date_and_time_representations) format
          example: 2015-08-11T11:45:16.285+01:00
    CardIdentifiers:
      type: object
      properties:
        cardIdentifier:
          type: string
          description: The unique identifier used to submit the card details in the transaction registration. This identifier will represent the customer card details.
          example: C6F92981-8C2D-457A-AA1E-16EBCD6D3AC6
        expiry:
          type: string
          description: Date/Time the card identifier will expire in [ISO 8601](http://en.wikipedia.org/wiki/ISO_8601#Combined_date_and_time_representations) format
          example: 2015-08-11T11:45:16.285+01:00
        cardType:
          type: string
          description: The type of the card (Visa, MasterCard, American Express, Diners, etc.)
          example: Visa
    billingAddress:
      type: object
      description: The `billingAddress` object is used to define the customer's billing address details. The billing address details will also be used as shipping address details if the `shippingDetails` object is not provided for a transaction.
      properties:
        address1:
          type: string
          maxLength: 50
          description: Billing address line 1, used in AVS check.
          example: 407 St. John Street
        address2:
          type: string
          maxLength: 50
          description: Billing address line 2.
        address3:
          type: string
          maxLength: 50
          description: Billing address line 3.
        city:
          type: string
          maxLength: 40
          description: Billing city.
          example: London
        postalCode:
          type: string
          maxLength: 10
          description: Billing postal code, used in AVS check. Not required when `country` is `IE`.
          example: EC1V 4AB
        country:
          type: string
          maxLength: 2
          minLength: 2
          description: Two letter country code defined in [ISO 3166-1](http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2)
          example: GB
        state:
          maxLength: 2
          minLength: 2
          type: string
          description: Two letter state code defined in [ISO 3166-2](http://en.wikipedia.org/wiki/ISO_3166-2:US). Required when `country` is `US`.
      required:
        - address1
        - city
        - country
    shippingDetails:
      type: object
      description: The `shippingDetails` object is used to specify the shipping address details for a transaction. If not provided the values provided in the `billingAddress` object will be used for shipping information instead.
      properties:
        recipientFirstName:
          type: string
          maxLength: 20
          description: Recipient's first names.
          example: Sam
        recipientLastName:
          type: string
          maxLength: 20
          description: Recipient's last name.
          example: Jones
        shippingAddress1:
          type: string
          maxLength: 50
          description: Shipping address line 1.
          example: 407 St. John Street
        shippingAddress2:
          type: string
          maxLength: 50
          description: Shipping address line 2.
        shippingAddress3:
          type: string
          maxLength: 50
          description: Shipping address line 3.
        shippingCity:
          maxLength: 40
          type: string
          description: Shipping city.
          example: London
        shippingPostalCode:
          maxLength: 10
          type: string
          description: Shipping postal code. Not required when `shippingCountry` is `IE`.
          example: EC1V 4AB
        shippingCountry:
          type: string
          maxLength: 2
          minLength: 2
          description: Shipping country. Two letter country code defined in [ISO 3166-1](http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2)
          example: GB
        shippingState:
          type: string
          maxLength: 2
          minLength: 2
          description: Two letter state code defined in [ISO 3166-2](http://en.wikipedia.org/wiki/ISO_3166-2:US). Required when `shippingCountry` is `US`.
      required:
        - recipientFirstName
        - recipientLastName
        - shippingAddress1
        - shippingCity
        - shippingCountry
    card:
      type: object
      description: The `card` object represents the credit or debit card details for this transaction.
      properties:
        merchantSessionKey:
          type: string
          format: uuid
          description: The merchant session key used to generate the `cardIdentifier`.
          example: 90BDF208-3C19-40AC-858B-3F4054DCD1C0
        cardIdentifier:
          type: string
          format: uuid
          description: The unique reference of the card you want to charge.
          example: 7F3CCA38-0BDA-453B-BF62-9CBD5891F77E
        reusable:
          type: boolean
          description: A flag to indicate the card identifier is reusable, i.e. it has been created previously.
          default: false
        save:
          type: boolean
          description: A flag to indicate that you want to save the card identifier, i.e. make it reusable.
          default: false
      required:
        - merchantSessionKey
        - cardIdentifier
    paymentMethod:
      type: object
      description: The `paymentMethod` object specifies the payment method for the transaction. You should only supply one of the objects below
      properties:
        card:
          $ref: '#/components/schemas/card'
        applepay:
          $ref: '#/components/schemas/applepay'
    paypal:
      type: object
      description: The `paypal` object represents the PayPal specific information required for this transaction.
      properties:
        merchantSessionKey:
          type: string
          format: uuid
          description: The merchant session key used to initiate the transaction.
          example: 90BDF208-3C19-40AC-858B-3F4054DCD1C0
        callbackurl:
          type: string
          format: uuid
          description: The URL to return the shopper to after the transaction
          example: https://www.example.com


    applepay:
      type: object
      description: The `applepay` object represents the ApplePay specific information required for this transaction.
      properties:

        payload:
          type: string
          description: The encrypted transaction payload from Apple
          example: AAAAAAABBBBBCCCCCC
        clientIpAddress:
          type: string
          example: 10.20.30.40
          description: The browser / device IP address
        sessionValidationToken:
          type: string
          example: SFGVHSBEVGAV/VDAYRR+345S
          description: The token from the getApplePaySession response. This token must be presented exactly as it appears in the response.

    amount:
      type: object
      description: The `amount` object provides information regarding the total, sale and surcharge amounts for the transaction. The `amount` is only returned in response to GET requests to the transactions resource.
      properties:
        totalAmount:
          type: integer
          example: 1000
          description: The total amount for the transaction that includes any sale or surcharge values.
        saleAmount:
          type: integer
          example: 1000
          description: The sale amount associated with the cost of goods or services for the transaction.
        surchargeAmount:
          type: integer
          example: 0
          description: The surcharge amount added to the transaction as per the settings of the account.
    avsCvcCheck:
      type: object
      description: The `avsCvcCheck` object provides information regarding the AVS/CV2 check results.
      properties:
        status:
          type: string
          description: The overall check result status.
          enum:
            - AllMatched
            - SecurityCodeMatchOnly
            - AddressMatchOnly
            - NoMatches
            - NotChecked
        address:
          type: string
          description: The result for address check.
          enum:
            - Matched
            - NotProvided
            - NotChecked
            - NotMatched
        postalCode:
          type: string
          description: The result for postal code check.
          enum:
            - Matched
            - NotProvided
            - NotChecked
            - NotMatched
        securityCode:
          type: string
          description: The result for security code check.
          enum:
            - Matched
            - NotProvided
            - NotChecked
            - NotMatched
    3DSecure:
      type: object
      properties:
        status:
          type: string
          enum:
            - Authenticated
            - NotChecked
            - NotAuthenticated
            - Error
            - CardNotEnrolled
            - IssuerNotEnrolled
            - MalformedOrInvalid
            - AttemptOnly
            - Incomplete
          description: >
            The 3D Secure status of the transaction, if applied.
             * `Ok` - Transaction request completed successfully.

             * `Authenticated` - 3D Secure checks carried out and user authenticated correctly.
             * `NotChecked` - 3D Secure checks were not performed. This indicates that 3D Secure was either switched off at the account level, or disabled at transaction registration with the `apply3DSecure` set to `Disable`.
             * `NotAuthenticated` - 3D Secure authentication checked, but the user failed the authentication.
             * `Error` - Authentication could not be attempted due to data errors or service unavailability in one of the parties involved in the check.
             * `CardNotEnrolled` - This means that the card is not in the 3D Secure scheme.
             * `IssuerNotEnrolled` - This means that the issuer is not part of the 3D Secure scheme.
             * `MalformedOrInvalid` - This means that there is a problem with creating or receiving the 3D Secure data. These should not occur on the live environment.
             * `AttemptOnly` - This means that the cardholder attempted to authenticate themselves but the process did not complete. A liability shift may occur for non-Maestro cards, depending on your merchant agreement.
             * `Incomplete` - This means that the 3D Secure authentication was not available (normally at the card issuer site).

    strongCustomerAuthentication:
      type: object
      description: The `strongCustomerAuthentication` object is used for 3D Secure Version 2.
      properties:
        notificationURL:
          type: string
          description: Fully qualified URL of the system that receives the CRes message or Error Message and where your customer will be returned once they have completed their challenge. The CRes message is posted by the ACS through the Cardholder browser at the end of the challenge AND once it receives an RRes (Result Response) message from Opayo.
          example: https://mydomain.com
          maxLength: 256
        browserIP:
          type: string
          description: The IPv4 or IPv6 address of the client connecting to your server making the payment as returned by the HTTP headers. This should be a full IP address which you can obtain from your server scripts. There is no need to pad IPv4 IP addresses with leading zeros (eg 12.34.45.56 not 012.034.045.056), doing so will cause transactions to be rejected.
          maxLength: 39
        browserAcceptHeader:
          type: string
          minLength: 1
          maxLength: 2048
          description: Exact content of the HTTP accept headers as sent to the 3DS Requestor from the Cardholder's browser.
          example: \*/\*
        browserJavascriptEnabled:
          type: boolean
          description: Boolean that represents the ability of the cardholder browser to execute JavaScript.
          default: false
        browserJavaEnabled:
          type: boolean
          description: Boolean that represents the ability of the cardholder browser to execute Java. Value is returned from the `navigator.javaEnabled` property. Required if `browserJavascriptEnabled` is `true`.
          default: false
        browserLanguage:
          type: string
          description: Value representing the browser language as defined in IETF BCP47. Returned from `navigator.language` property.
          minLength: 1
          maxLength: 8
        browserColorDepth:
          type: string
          description: >
            Value representing the bit depth of the colour palette for displaying images, in bits per pixel.

             Obtained from Cardholder browser using the `screen.colorDepth` property.

             * `1` = 1 bit
             * `4` = 4 bits
             * `8` = 8 bits
             * `15` = 15 bits
             * `16` = 16 bits
             * `24` = 24 bits
             * `32` = 32 bits
             * `48` = 48 bits

            Required if `browserJavascriptEnabled` is `true`.
          enum:
            - 1
            - 4
            - 8
            - 15
            - 16
            - 24
            - 32
            - 48
          minLength: 1
          maxLength: 2

        browserScreenHeight:
          type: string
          description: Total height of the Cardholder's screen in pixels. Value is returned from the `screen.height` property. Required if `BrowserJavascriptEnabled` is `true`.
          minLength: 1
          maxLength: 6

        browserScreenWidth:
          type: string
          description: Total width of the cardholder's screen in pixels. Value is returned from the `screen.width` property. Required if `BrowserJavascriptEnabled` is `true`.
          minLength: 1
          maxLength: 6

        browserTZ:
          type: string
          description: >
            Time-zone offset in minutes between UTC and the Cardholder browser local time.

             `Note` : The offset is positive if the local time zone is behind UTC and negative if it is ahead.

              Example time zone offset values in minutes:

            If UTC -5 hours (-300 minutes):
             * 300
             * +300

            If UTC +5 hours (300 minutes):
             * -300

            Required if `browserJavascriptEnabled` is `true`.

          minLength: 1
          maxLength: 6
        browserUserAgent:
          type: string
          minLength: 1
          maxLength: 2048
          description: Exact content of the HTTP user-agent header.
          example: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:67.0) Gecko/20100101 Firefox/67.0

        challengeWindowSize:
          type: string
          description: >
            Dimensions of the challenge window that has been displayed to the Cardholder.

             The ACS shall reply with content that is formatted to appropriately render the challenge UI in this window, to provide the best possible user experience.  Preconfigured sizes are width x height in pixels of the window displayed in the Cardholder browser window.

             * `Small` = 250 x 400
             * `Medium` = 390 x 400
             * `Large` = 500 x 600
             * `ExtraLarge` = 600 x 400
             * `FullScreen` = Full screen

          enum:
            - 'Small'
            - 'Medium'
            - 'Large'
            - 'ExtraLarge'
            - 'FullScreen'

        acctID:
          type: string
          description: The account ID, if applicable, of your customers account on your website.
          maxLength: 64

        transType:
          type: string
          description: >
            Identifies the type of transaction being authenticated.

              * `GoodsAndServicePurchase` = Goods/ Service Purchase
              * `CheckAcceptance` = Check Acceptance
              * `AccountFunding` = Account Funding
              * `QuasiCashTransaction` = Quasi-Cash Transaction
              * `PrepaidActivationAndLoad` = Prepaid Activation and Load

            Values derived from the 8583 ISO Standard.
          enum:
            - 'GoodsAndServicePurchase'
            - 'CheckAcceptance'
            - 'AccountFunding'
            - 'QuasiCashTransaction'
            - 'PrepaidActivationAndLoad'

        threeDSRequestorAuthenticationInfo:
          type: object
          description: Information about how you authenticated the cardholder before or during the transaction. E.g. Did your customer log into their online account on your website, using two-factor authentication, or did they log in as a guest.
          properties:
            threeDSReqAuthData:
              type: string
              description: Data that documents and supports a specific authentication process. In the current version of the EMVCo specification, this data element is not yet defined.
              maxLength: 2048

            threeDSReqAuthMethod:
              type: string
              description: >
                Mechanism used by the Cardholder to authenticate when they logged into their online account, on your website.

                  * `NoThreeDSRequestorAuthentication` = No authentication occurred (i.e. cardholder 'logged in? as guest).
                  * `LoginWithThreeDSRequestorCredentials` = Login to the cardholder account at the merchant's website using the merchant's own authentication credentials.
                  * `LoginWithFederatedId` = Login to the cardholder account at the merchant's website using federated ID.
                  * `LoginWithIssuerCredentials` = Login to the cardholder account at the merchant's website using the card issuer's authentication credentials.
                  * `LoginWithThirdPartyAuthentication` = Login to the cardholder account at the merchant's website using third-party authentication.
                  * `LoginWithFIDOAuthenticator` = Login to the cardholder account at the merchant's website using FIDO Authenticator.
              enum:
                - 'NoThreeDSRequestorAuthentication'
                - 'LoginWithThreeDSRequestorCredentials'
                - 'LoginWithFederatedId'
                - 'LoginWithIssuerCredentials'
                - 'LoginWithThirdPartyAuthentication'
                - 'LoginWithFIDOAuthenticator'
              example: 'LoginWithThreeDSRequestorCredentials'

            threeDSReqAuthTimestamp:
              type: string
              description: Date and time in UTC of the cardholder authentication when they logged into their online account, on your website.
              maxLength: 12
              example: "201810011445"

        threeDSRequestorPriorAuthenticationInfo:
          type: object
          description: Information about how you authenticated the cardholder as part of a previous 3DS transaction. E.g. Were they authenticated via frictionless authentication or did a cardholder challenge occur.
          properties:
            threeDSReqPriorAuthData:
              type: string
              description: Data that documents and supports a specific authentication process. In the current version of the EMVCo specification, this data element is not yet defined.
              example: data

            threeDSReqPriorAuthMethod:
              description: >
                Mechanism used by the Cardholder during a previous 3DS authentication, as part of a previous transaction request.

                 * `FrictionlessAuthentication` = Frictionless authentication occurred by the ACS
                 * `ChallengeAuthentication` = Cardholder challenge occurred by ACS
                 * `AVSVerified` = AVS verified
                 * `OtherIssuerMethods` = Other issuer methods
              enum:
                - 'FrictionlessAuthentication'
                - 'ChallengeAuthentication'
                - 'AVSVerified'
                - 'OtherIssuerMethods'
              example: 'FrictionlessAuthentication'

            threeDSReqPriorAuthTimestamp:
              type: string
              description: Date and time in UTC of the prior cardholder 3DS authentication.
              example: "201901011645"

            threeDSReqPriorRef:
              type: string
              description: This data element provides additional information to the ACS to determine the best approach for handling a request. It will contain an ACS Transaction ID for a prior authenticated transaction (for example, the first recurring transaction that was authenticated with the cardholder). This ID will be available in future via MySagePay and the Reporting and Admin API.
              example: "2cd842f5-da5d-40b7-8ae6-6ce61cc7b580"
              minLength: 36
              maxLength: 36

        acctInfo:
          type: object
          description: Additional information about the Cardholder's account that has been provided by you. E.g. How long has the cardholder had the account on your website.
          properties:
            chAccAgeInd:
              type: string
              description: >
                Length of time that the cardholder has had their online account with you.

                  * `GuestCheckout` = No account (guest check-out)
                  * `CreatedDuringTransaction` = Created during this transaction
                  * `LessThanThirtyDays` = Less than 30 days
                  * `ThirtyToSixtyDays` = 30-60 days
                  * `MoreThanSixtyDays` = More than 60 days
              enum:
                - 'GuestCheckout'
                - 'CreatedDuringTransaction'
                - 'LessThanThirtyDays'
                - 'ThirtyToSixtyDays'
                - 'MoreThanSixtyDays'
              example: 'MoreThanSixtyDays'

            chAccChange:
              type: string
              description: Date that the cardholder's online account last changed, including Billing or Shipping address, new payment account, or new user(s) added.
              example: "20180925"

            chAccChangeInd:
              type: string
              description: >
                Length of time since the cardholder's online account information last changed, including Billing or Shipping address, new payment account, or new user(s) added.
                  * `DuringTransaction` = Changed during this transaction
                  * `LessThanThirtyDays` = Less than 30 days
                  * `ThirtyToSixtyDays` = 30-60 days
                  * `MoreThanSixtyDays` = More than 60 days
              enum:
                - 'DuringTransaction'
                - 'LessThanThirtyDays'
                - 'ThirtyToSixtyDays'
                - 'MoreThanSixtyDays'
              example: "MoreThanSixtyDays"

            chAccDate:
              type: string
              description: Date that the cardholder opened their online account with you.
              minLength: 8
              maxLength: 8
              example: '20180925'

            chAccPwChange:
              type: string
              description: Date that cardholder's online account had a password change or account reset.
              minLength: 8
              maxLength: 8
              example: '20180926'

            chAccPwChangeInd:
              type: string
              description: >
                Indicates the length of time since the cardholder's online account had a password change or account reset.
                  * `NoChange` = No change
                  * `DuringTransaction` = Changed during this transaction
                  * `LessThanThirtyDays` = Less than 30 days
                  * `ThirtyToSixtyDays` = 30-60 days
                  * `MoreThanSixtyDays` = More than 60 days
              enum:
                - 'NoChange'
                - 'DuringTransaction'
                - 'LessThanThirtyDays'
                - 'ThirtyToSixtyDays'
                - 'MoreThanSixtyDays'
              example: "MoreThanSixtyDays"

            nbPurchaseAccount:
              type: string
              description: Number of purchases with this cardholder account during the previous six months.
              maxLength: 4
              example: "5"

            provisionAttemptsDay:
              type: string
              description: Number of Add Card attempts in the last 24 hours.
              maxLength: 3
              example: "0"

            txnActivityDay:
              type: string
              description: Number of transactions (successful and abandoned) for this cardholder account with you, across all payment accounts in the previous 24 hours.
              maxLength: 3
              example: "1"

            txnActivityYear:
              type: string
              description: Number of transactions (successful and abandoned) for this cardholder account with you, across all payment accounts in the previous year.
              maxLength: 3
              example: "24"

            paymentAccAge:
              type: string
              description: Date that the payment account was enrolled in the cardholder's account with you.
              minLength: 8
              maxLength: 8
              example: '20180228'

            paymentAccInd:
              type: string
              description: >
                Indicates the length of time that the payment account was enrolled in the cardholder's account with you.
                  * `GuestCheckout` = No account (guest check-out)
                  * `DuringTransaction` = During this transaction
                  * `LessThanThirtyDays` = Less than 30 days
                  * `ThirtyToSixtyDays` = 30-60 days
                  * `MoreThanSixtyDays` = More than 60 day
              enum:
                - 'GuestCheckout'
                - 'DuringTransaction'
                - 'LessThanThirtyDays'
                - 'ThirtyToSixtyDays'
                - 'MoreThanSixtyDays'
              example: 'MoreThanSixtyDays'

            shipAddressUsage:
              type: string
              description: Date when the shipping address used for this transaction was first used with you.
              minLength: 8
              maxLength: 8
              example: '20180220'

            shipAddressUsageInd:
              type: string
              description: >
                Indicates when the shipping address used for this transaction was first used with you.
                  * `ThisTransaction` = This transaction
                  * `LessThanThirtyDays` = Less than 30 days
                  * `ThirtyToSixtyDays` = 30-60 days
                  * `MoreThanSixtyDays` = More than 60 days
              enum:
                - 'ThisTransaction'
                - 'LessThanThirtyDays'
                - 'ThirtyToSixtyDays'
                - 'MoreThanSixtyDays'
              example: "MoreThanSixtyDays"

            shipNameIndicator:
              type: string
              description: >
                Indicates if the Cardholder Name on the account is identical to the shipping Name used for this transaction.
                 * `FullMatch` = Account Name identical to shipping Name
                 * `NoMatch` = Account Name different than shipping Name
              enum:
                - 'FullMatch'
                - 'NoMatch'
              example: "FullMatch"

            suspiciousAccActivity:
              type: string
              description: >
                Indicates whether you have experienced suspicious activity (including previous fraud) on the cardholder account.
                 * `NotSuspicious` = No suspicious activity has been observed
                 * `Suspicious` = Suspicious activity has been observed
              enum:
                - 'NotSuspicious'
                - 'Suspicious'
              example: "NotSuspicious"

        merchantRiskIndicator:
          type: object
          description: Merchant's assessment of the level of fraud risk for the specific authentication for both the cardholder and the authentication being conducted. E.g. Are you shipping goods to the cardholder's billing address, is this a first-time order or reorder.
          properties:

            deliveryEmailAddress:
              type: string
              description: For Electronic delivery, the email address to which the merchandise was delivered.
              maxLength: 50
              example: customer@domain.com

            deliveryTimeframe:
              type: string
              description: >
                Indicates the merchandise delivery timeframe.
                  * `ElectronicDelivery` = Electronic Delivery
                  * `SameDayShipping` = Same day shipping
                  * `OvernightShipping` = Overnight shipping
                  * `TwoDayOrMoreShipping` = Two-day or more shipping
              enum:
                - 'ElectronicDelivery'
                - 'SameDayShipping'
                - 'OvernightShipping'
                - 'TwoDayOrMoreShipping'
              example: "OvernightShipping"

            giftCardAmount:
              type: string
              description: For prepaid or gift card purchase, the purchase amount total of prepaid or gift card(s) in major units (for example, GBP 123.45 is 123).
              maxLength: 15
              example: "123"

            giftCardCount:
              type: string
              description: For prepaid or gift card purchase, total count of individual prepaid or gift cards/codes purchased.
              maxLength: 2
              example: "2"

            preOrderDate:
              type: string
              description: For a pre-ordered purchase, the expected date that the merchandise will be available.
              minLength: 8
              maxLength: 8
              example: '20200220'

            preOrderPurchaseInd:
              type: string
              description: >
                Indicates whether Cardholder is placing an order for merchandise with a future availability or release date.
                  * `MerchandiseAvailable` = Merchandise available
                  * `FutureAvailability` = Future availability
              enum:
                - 'MerchandiseAvailable'
                - 'FutureAvailability'
              example: "MerchandiseAvailable"

            reorderItemsInd:
              type: string
              description: >
                Indicates whether the cardholder is reordering previously purchased merchandise.
                  * `FirstTimeOrdered` = First time ordered
                  * `Reordered` = Reordered
              enum:
                - 'FirstTimeOrdered'
                - 'Reordered'
              example: "Reordered"

            shipIndicator:
              type: string
              description: >
                Indicates shipping method chosen for the transaction. You must choose the Shipping Indicator code that most accurately describes the cardholder's specific transaction, not their general business.  If one or more items are included in the sale, use the Shipping Indicator code for the physical goods, or if all digital goods, use the Shipping Indicator code that describes the most expensive item.
                  * `CardholderBillingAddress` = Ship to cardholder's billing address
                  * `OtherVerifiedAddress` = Ship to another verified address on file with merchant
                  * `DifferentToCardholderBillingAddress` = Ship to address that is different than the cardholder's billing address
                  * `LocalPickUp` = 'Ship to Store? / Pick-up at local store (Store address shall be populated in shipping address fields)
                  * `DigitalGoods` = Digital goods (includes online services, electronic gift cards and redemption codes)
                  * `NonShippedTickets` = Travel and Event tickets, not shipped
                  * `Other` = Other (for example, Gaming, digital services not shipped, e-media subscriptions, etc.)
              enum:
                - 'CardholderBillingAddress'
                - 'OtherVerifiedAddress'
                - 'DifferentToCardholderBillingAddress'
                - 'LocalPickUp'
                - 'DigitalGoods'
                - 'NonShippedTickets'
                - 'Other'
              example: "CardholderBillingAddress"

        threeDSExemptionIndicator:
              type: string
              description: >
                Indicates the reason you're bypassing 3D Secure authentication. Use in conjunction with `apply3DSecure`:`Disable`. You must first get permission from your acquirer to use exemptions. Using exemptions means that fraud liability, for the transaction, is shifted to you the merchant. If the card issuer does not agree with the exemption, they can return a 'soft decline' - response code of `bankResponseCode`:`65` or `bankResponseCode`:`1A` - Opayo will automatically request for 3D Secure authentication and submit another authorisation request to the card issuer with 3D Secure authentication data. It is important that you correctly populate the required field values for the `strongCustomerAuthentication` object.
                  * `LowValue` = Low Value Transaction (LVT); the transaction value must be 30 EUR or less and is permitted for a maximum of five consecutive LVTs or a maximum cumulative LVT amount can be 100 EUR. On the sixth LVT or when the cumulative LVT amount is over 100 EUR, then 3D Secure authentication must be performed. Since the cardholder could have used their LVT exemptions elsewhere on other merchants' sites, you would not be able to accurately use this exemption. Only the card issuer will know if the LVT exemption counters have been reached.
                  * `TransactionRiskAnalysis` = Transaction Risk Analysis (TRA); if you or your acquirer have a low number of chargebacks over a given number of transactions, the card schemes will have more trust in you and the acquirer and permit eligible merchants to bypass authentication using the TRA exemption.
                  * `TrustedMerchant` = Trusted beneficiaries / merchant; you can use this exemption if the cardholder adds you to a trusted beneficiaries list. They can do this if prompted to do so by their card issuer either when they log into their bank account or during a challenge authentication flow.
                  * `SecureCorporatePayment` = Secure Corporate Payments; if your client uses a secure corporate card such as a lodge corporate card or virtual card numbers, then these are exempt from 3D Secure authentication. These payments will be typically Business to Business payments (B2B), which will already have dedicated corporate processes and protocols in place. This exemption does not apply for personal corporate cards.
                  * `DelegatedAuthentication` = Delegated Authentication; You can request for this exemption to not perform 3D Secure authentication again if you have already performed it. To be able to do this, you must already have undergone accreditation with the card schemes for 3D Secure authentication. This means the card schemes now trust you to perform 3D Secure authentication independently of them (the card schemes have delegated authentication to you).
              enum:
                - 'LowValue'
                - 'TransactionRiskAnalysis'
                - 'TrustedMerchant'
                - 'SecureCorporatePayment'
                - 'DelegatedAuthentication'
              example: "TransactionRiskAnalysis"

        website:
          type: string
          description: Fully qualified URL of the website this transaction came from. This field is useful if transactions can originate from more than one website.  Supplying this information will enable reporting to be performed by website.
          example: https://mydomain.com
          maxLength: 100
      required:
        - notificationURL
        - browserIP
        - browserAcceptHeader
        - browserJavascriptEnabled
        - browserUserAgent
        - challengeWindowSize
        - transType
        - browserLanguage

    credentialType:
      type: object
      description: The `credentialType` object is required when creating a token `Save`:`true` or using a token `reusable`:`true` or for Repeat transactions where `transactionType`:`Repeat`. It advises the card issuer the reason why your storing a credential on file, and when using a stored credential.
      properties:
        cofUsage:
          type: string
          description: >
            Indicates whether you are storing the credential to file for the first time. When storing the credential for the first time you must also submit the `strongCustomerAuthentication` object and `apply3DSecure`:`Force`, as the cardholder must undergo a 3D Secure authentication with a challenge before you can safely store the credential to file. 3D Secure authentication is not currently required for Mail Order Telephone Order (MOTO) transactions.
              * `First` = You are first storing a credential on file.
              * `Subsequent` = You are using a stored credential
          enum:
            - 'First'
            - 'Subsequent'
          example: "First"
        initiatedType:
          type: string
          description: >
            Indicates whether the cardholder is in-session (CIT), where they are on your website and they select the submit button to make a payment. Or the cardholder is off-session (MIT), where they are not involved in the payment flow and the merchant initiates the transaction for goods or services provided.
              * `CIT` = Consumer Initiated Transaction also known as Cardholder Initiated Transaction. 3D Secure authentication is required unless it is a MOTO transaction.
              * `MIT` = Merchant Initiated Transaction. The `cofUsage`:`Subsequent` must be submitted. 3D Secure authentication is not required.
          enum:
            - 'CIT'
            - 'MIT'
          example: "CIT"
        mitType:
          type: string
          description: >
            Indicates what you'll be storing and using the credential on file for. You must check first with your acquirer to see that they support the type of MIT you intend to use. Unscheduled Credential on File and Recurring payments are typically supported by all acquirers.
            Required if `initiatedType`:`MIT`, highly recommended if `initiatedType`:`CIT`.
              * `Instalment` = A single purchase of goods/services paid for over multiple payments.
              * `Recurring` = A purchase of goods/services provided at fixed regular intervals not exceeding one year between transactions.
              * `Unscheduled` = A purchase of goods/services provided at irregular intervals with a fixed or variable amount.
              * `Incremental` = An additional purchase made after an initial or estimated authorisation. Example; room service is added to the cardholders stay. Only available for certain MCCs, such as Hotels, Car Rental companies.
              * `DelayedCharge` = An additional charge made after original services are rendered. Example; a parking fine. Only available for certain MCCs such as Car Rental companies.
              * `NoShow` = A charge for services where the cardholder entered into an agreement to purchase, but did not meet the terms of the agreement. Example; A no show after booking a hotel room. Only available for certain MCCs, such as Hotels, Car Rental companies.
              * `Reauthorisation` = A further purchase is made after the original purchase.  Example; extended stays/rentals. Can also be used in split shipment scenarios.
              * `Resubmission` = An authorisation request has been declined due to insufficient funds `bankResponseCode`:`51`, at the time the goods or services have already provided. You can resubmit your transaction to attempt to get a successful authorisation.
          enum:
            - 'Instalment'
            - 'Recurring'
            - 'Unscheduled'
            - 'Incremental'
            - 'DelayedCharge'
            - 'NoShow'
            - 'Reauthorisation'
            - 'Resubmission'
          example: "Unscheduled"
        recurringExpiry:
          type: string
          description:  YYYYMMDD. Required if `mitType`:`Recurring` or `mitType`:`Instalment`. This value relates to the date of when the last Recurring payment or Instalment will occur. If you submit a Recurring or Instalment transaction request after this date for the stored credential, the card issuer may decline the transaction or provide a 'soft decline'.
          example: "20200301"
          maxLength: 8
        recurringFrequency:
          type: string
          description:  Value is in days. Required if `mitType`:`Recurring` or `mitType`:`Instalment`. The regular frequency of the Recurring payment or Instalment.
          example: "28"
          maxLength: 4
        purchaseInstalData:
          type: string
          description:  Value is in days. Required if `mitType`:`Instalment`. Must be a value greater than 1, example, 2 and upwards. The number of instalments required to fully pay off the received goods or services. Any extra instalments taken greater than the value entered, may lead to the card issuer declining the transaction request.
          example: "6"
          maxLength: 3
      required:
        - cofUsage
        - initiatedType
      

    credentialTypeRepeat:
      type: object
      description: The `credentialType` object is required for Repeat transactions where `transactionType`:`Repeat`. It advises the card issuer the reason you are using a stored credential.
      properties:
        cofUsage:
          type: string
          description: >
            Required when you are repeating a previously stored credential.
              * `Subsequent` = You are using a stored credential
          enum:
            - 'Subsequent'
          example: "Subsequent"
        initiatedType:
          type: string
          description: >
            Indicates whether the cardholder is in-session (CIT), where they are on your website and they select the submit button to make a payment. Or the cardholder is off-session (MIT), where they are not involved in the payment flow and the merchant initiates the transaction for goods or services provided. Repeats will always be classed as Merchant Initiated Transactions (MIT).
              * `MIT` = Merchant Initiated Transaction. The `cofUsage`:`Subsequent` must be submitted. 3D Secure authentication is not required.
          enum:
            - 'MIT'
          example: "MIT"
        mitType:
          type: string
          description: >
            Indicates what you'll be storing and using the credential on file for. You must check first with your acquirer to see that they support the type of MIT you intend to use. Unscheduled Credential on File and Recurring payments are typically supported by all acquirers.
            Required if `initiatedType`:`MIT`, highly recommended if `initiatedType`:`CIT`.
              * `Instalment` = A single purchase of goods/services paid for over multiple payments.
              * `Recurring` = A purchase of goods/services provided at fixed regular intervals not exceeding one year between transactions.
              * `Unscheduled` = A purchase of goods/services provided at irregular intervals with a fixed or variable amount.
              * `Incremental` = An additional purchase made after an initial or estimated authorisation. Example; room service is added to the cardholders stay. Only available for certain MCCs, such as Hotels, Car Rental companies.
              * `DelayedCharge` = An additional charge made after original services are rendered. Example; a parking fine. Only available for certain MCCs such as Car Rental companies.
              * `NoShow` = A charge for services where the cardholder entered into an agreement to purchase, but did not meet the terms of the agreement. Example; A no show after booking a hotel room. Only available for certain MCCs, such as Hotels, Car Rental companies.
              * `Reauthorisation` = A further purchase is made after the original purchase.  Example; extended stays/rentals. Can also be used in split shipment scenarios.
              * `Resubmission` = An authorisation request has been declined due to insufficient funds `bankResponseCode`:`51`, at the time the goods or services have already provided. You can resubmit your transaction to attempt to get a successful authorisation.
          enum:
            - 'Instalment'
            - 'Recurring'
            - 'Unscheduled'
            - 'Incremental'
            - 'DelayedCharge'
            - 'NoShow'
            - 'Reauthorisation'
            - 'Resubmission'
          example: "Unscheduled"
        recurringExpiry:
          type: string
          description:  YYYYMMDD. Required if `mitType`:`Recurring` or `mitType`:`Instalment`. This value relates to the date of when the last Recurring payment or Instalment will occur. If you submit a Recurring or Instalment transaction request after this date for the stored credential, the card issuer may decline the transaction or provide a 'soft decline'.
          example: "20200301"
          maxLength: 8
        recurringFrequency:
          type: string
          description:  Value is in days. Required if `mitType`:`Recurring` or `mitType`:`Instalment`. The regular frequency of the Recurring payment or Instalment.
          example: "28"
          maxLength: 4
        purchaseInstalData:
          type: string
          description:  Value is in days. Required if `mitType`:`Instalment`. Must be a value greater than 1, example, 2 and upwards. The number of instalments required to fully pay off the received goods or services. Any extra instalments taken greater than the value entered, may lead to the card issuer declining the transaction request.
          example: "6"
          maxLength: 3
      required:
        - cofUsage
        - initiatedType
      

    fiRecipient:
      type: object
      description: The `fiRecipient` object is required if your Merchant Category Code (MCC) has a value of 6012 (Financial Institution). This is a card scheme mandated requirement. If provided in the transaction request, the `fiRecipient` object and it's data will be returned in the transaction response.
      properties:
        accountNumber:
          type: string
          description: >
            Primary recipient's account number. This can either be:
              * The first 6 and last 4 characters of the primary recipient's card PAN (no spaces).
              * Where the primary recipient's account is not a card PAN; this will contain up to 10 characters of the account number (alphanumeric), unless the account number is less than 10 characters long, in which case the account number will be present in its entirety.
          maxLength: 10
          example: "1234567890"
        surname:
          type: string
          description: >
            This is the surname of the primary recipient. No special characters such as apostrophes or hyphens are permitted.
          maxLength: 20
          example: "Surname"
        postcode:
          type: string
          description: >
            This is the postcode of the primary recipient.
          maxLength: 10
          example: "EC1V 8AB"
        dateOfBirth:
          type: string
          description: This is the date of birth of the primary recipient in the format YYYYMMDD.
          maxLength: 8
          example: "19900101"
      required:
        - accountNumber
        - surname
        - postcode
        - dateOfBirth

    Card:
      type: object
      description: The response returned by Opayo for a card based transaction
      properties:
        transactionId:
          type: string
          description: Opayo's unique reference for this transaction.
          example: DB79BA2D-05DA-5B85-D188-1293D16BBAC7
        acsTransId:
          type: string
          description: Access Control Server (ACS) transaction ID. This is a unique ID provided by the card issuer for 3DSv2 authentications.
          example: 43b04fd1-692c-4b76-ac20-a75527ad0a25
        dsTransId:
          type: string
          description: Directory Server (DS) transaction ID. This is a unique ID provided by the card scheme for 3DSv2 authentications.
          example: 7980e36f-907b-4530-84fd-ccc1f40bf9ae
        transactionType:
          type: string
          description: The type of the transaction
          enum:
            - Payment
            - Deferred
            - Authenticate
            - Repeat
            - Refund
        status:
          type: string
          enum:
            - Ok
            - NotAuthed
            - Rejected
            - Malformed
            - Invalid
            - Error
          description: >
            Result of transaction registration.
             * `Ok` - Transaction request completed successfully.
             * `NotAuthed` - Transaction request was not authorised by the bank.
             * `Rejected` - Transaction rejected by your fraud rules.
             * `Malformed` - Missing properties or badly formed body.
             * `Invalid` - Invalid property values supplied.
             * `Error` - An error occurred at Opayo.
        statusCode:
          type: string
          description: |
            Code related to the `status` of the transaction.
            *Successfully authorised transactions will have the `statusCode` of `0000`. You can lookup any other status code on our [website](https://www.opayo.co.uk/support/troubleshooting/error-code ).*
          example: 0000
        statusDetail:
          type: string
          description: A detailed reason for the `status` of the transaction.
          example: The Authorisation was Successful.
       
        additionalDeclineDetail:
          type: object
          description: The extended decline code detail which is returned by the card schemes. Use this detail to ascertain if you can retry a transaction, need to contact your customer or if you should abandon all further attempts.
          properties:
            additionalDeclineCode:
              type: string
              maxLength: 2
              minLength: 2
              description: This contains the additional decline code. (example values, 03, R1, N4, 59 etc.)
              example: N7
            additionalDeclineCodeDescription:
              type: string
              maxLength: 255
              description: Description of the additional decline code. This will vary according to your acquiring bank
              example: 'Incorrect CVV'
            additionalDeclineCodeCategory:
              type: string
              maxLength: 2
              minLength: 2
              description: >
                            This is the category of the decline. Currently there are 4 categories, but could increase in future. (Example 01, 02, 03, 04.)

                              01: Card declined, do not re-attempt within a rolling 30 day period.

                              02: Card issuer cannot approve at this time. Re-attempt authorisation permitted, but limited to 15 re-attempts within a rolling 30 day period.

                              03: Incorrect data, or updated or additional card account information is required. For these the authorisation data will need to be corrected before re-attempt. Such issues are incorrect / missing expiry date, authentication value. Contact cardholder and correct information. Note: Limited to 15 re-attempts within a rolling 30 day period and no more than 25,000 category 03 declines per MID per rolling 30 day period per card scheme.

                              04: Re-attempt authorisation permitted. Re-attempts limited to 15 within a rolling 30 day period. 
              example: '02'
   
   
     



        retrievalReference:
          type: string
          description: Opayo's unique Authorisation Code for a successfully authorised transaction. Only present if `status` is `Ok`.
          example: 9493946
        settlementReferenceText:
          type: string
          maxLength: 30
          description: A unique reference that you may wish to be displayed on your acquirer's settlement report (Not enabled for all acquirers. Please contact support for supported acquirers).
          example: 123456GRTY234


        bankResponseCode:
          type: string
          description: |
            Also known as the decline code, these are codes that are specific to your merchant bank. Please contact them for a description of each code. If a bank response code of `65` or `1A` is returned, this is known as a 'soft decline' and means the card issuer requests that your customer performs 3D Secure authentication, where they have to enter Two Factor Authentication (2FA) also known as Strong Customer Authentication (SCA). To achieve this, submit a payment request and provide the field and value `apply3DSecure:Force`.
            *This is only returned for transaction type `Payment`*
          example: 00
        bankAuthorisationCode:
          type: string
          description: The authorisation code returned from your merchant bank.
          example: 999777
        avsCvcCheck:
          description: Provides information regarding the AVS/CV2 check results.
            *This is only returned for Payment and Deferred* transactions.
          $ref: '#/components/schemas/avsCvcCheck'
        paymentMethod:
          type: object
          description: The `paymentMethod` object specifies the payment method for the transaction.
          properties:
            card:
              type: object
              description: The `card` object represents the credit or debit card details for this transaction.
              properties:
                cardType:
                  type: string
                  description: The type of the card used for the transaction.
                  example: Visa
                lastFourDigits:
                  type: string
                  description: The last 4 digits of the card number used for the transaction.
                  example: Visa
                expiry:
                  type: string
                  description: The expiry date of the card used for the transaction.
                  example: Visa
                cardIdentifier:
                  type: string
                  format: uuid
                  description: The unique reference of the card you want to charge.
                  example: 7F3CCA38-0BDA-453B-BF62-9CBD5891F77E
                reusable:
                  type: boolean
                  description: A flag to indicate the card identifier is reusable, i.e. it has been created previously.
                  default: false
        amount:
          type: object
          description: The amount charged to the customer in the smallest currency unit. (e.g 100 pence to charge £1.00, or 1 to charge ¥1 (0-decimal currency).
          $ref: '#/components/schemas/amount'
        currency:
          type: string
          maxLength: 3
          minLength: 3
          description: The currency of the amount in 3 letter [ISO 4217](https://en.wikipedia.org/wiki/ISO_4217) format.
          example: GBP
        3DSecure:
          description: Provides the 3D Secure status of the transaction, if applied.
          $ref: '#/components/schemas/3DSecure'
        fiRecipient:
          $ref: '#/components/schemas/fiRecipient'

    Applepay:
      type: object
      description: The response returned by Opayo for an Apple Pay transaction 
      properties:
        transactionId:
          type: string
          description: Opayo's unique reference for this transaction.
          example: DB79BA2D-05DA-5B85-D188-1293D16BBAC7
        transactionType:
          type: string
          description: The type of the transaction
          enum:
            - Payment
            - Deferred
            - Authenticate

        status:
          type: string
          enum:
            - Ok
            - NotAuthed
            - Rejected
            - Malformed
            - Invalid
            - Error
          description: >
            Result of transaction registration.
             * `Ok` - Transaction request completed successfully.
             * `NotAuthed` - Transaction request was not authorised by the bank.
             * `Rejected` - Transaction rejected by your fraud rules.
             * `Malformed` - Missing properties or badly formed body.
             * `Invalid` - Invalid property values supplied.
             * `Error` - An error occurred at Opayo.
        statusCode:
          type: string
          description: |
            Code related to the `status` of the transaction.
            *Successfully authorised transactions will have the `statusCode` of `0000`. You can lookup any other status code on our [website](https://www.opayo.co.uk/support/troubleshooting/error-code ).*
          example: 0000
        statusDetail:
          type: string
          description: A detailed reason for the `status` of the transaction.
          example: The Authorisation was Successful.
       
        additionalDeclineDetail:
          type: object
          description: The extended decline code detail which is returned by the card schemes. Use this detail to ascertain if you can retry a transaction, need to contact your customer or if you should abandon all further attempts.
          properties:
            additionalDeclineCode:
              type: string
              maxLength: 2
              minLength: 2
              description: This contains the additional decline code. (example values, 03, R1, N4, 59 etc.)
              example: N7
            additionalDeclineCodeDescription:
              type: string
              maxLength: 255
              description: Description of the additional decline code. This will vary according to your acquiring bank
              example: 'Incorrect CVV'
            additionalDeclineCodeCategory:
              type: string
              maxLength: 2
              minLength: 2
              description: >
                            This is the category of the decline. Currently there are 4 categories, but could increase in future. (Example 01, 02, 03, 04.)

                              01: Card declined, do not re-attempt within a rolling 30 day period.

                              02: Card issuer cannot approve at this time. Re-attempt authorisation permitted, but limited to 15 re-attempts within a rolling 30 day period.

                              03: Incorrect data, or updated or additional card account information is required. For these the authorisation data will need to be corrected before re-attempt. Such issues are incorrect / missing expiry date, authentication value. Contact cardholder and correct information. Note: Limited to 15 re-attempts within a rolling 30 day period and no more than 25,000 category 03 declines per MID per rolling 30 day period per card scheme.

                              04: Re-attempt authorisation permitted. Re-attempts limited to 15 within a rolling 30 day period. 
              example: '02'
   
   
     



        retrievalReference:
          type: string
          description: Opayo's unique Authorisation Code for a successfully authorised transaction. Only present if `status` is `Ok`.
          example: 9493946
        settlementReferenceText:
          type: string
          maxLength: 30
          description: A unique reference that you may wish to be displayed on your acquirer's settlement report (Not enabled for all acquirers. Please contact support for supported acquirers).
          example: 123456GRTY234


        bankResponseCode:
          type: string
          description: |
            Also known as the decline code, these are codes that are specific to your merchant bank. Please contact them for a description of each code. If a bank response code of `65` or `1A` is returned, this is known as a 'soft decline' and means the card issuer requests that your customer performs 3D Secure authentication, where they have to enter Two Factor Authentication (2FA) also known as Strong Customer Authentication (SCA). To achieve this, submit a payment request and provide the field and value `apply3DSecure:Force`.
            *This is only returned for transaction type `Payment`*
          example: 00
        bankAuthorisationCode:
          type: string
          description: The authorisation code returned from your merchant bank.
          example: 999777
        avsCvcCheck:
          description: Provides information regarding the AVS/CV2 check results.
            *This is only returned for Payment and Deferred* transactions.
          $ref: '#/components/schemas/avsCvcCheck'
        paymentMethod:
          type: object
          description: The `paymentMethod` object specifies the payment method for the transaction.
          properties:
            card:
              type: object
              description: The `card` object represents the credit or debit card details for this transaction.
              properties:
                cardType:
                  type: string
                  description: The type of the card used for the transaction.
                  example: Visa
                lastFourDigits:
                  type: string
                  description: The last 4 digits of the card number used for the transaction.
                  example: Visa
                expiry:
                  type: string
                  description: The expiry date of the card used for the transaction.
                  example: Visa
                cardIdentifier:
                  type: string
                  format: uuid
                  description: The unique reference of the card you want to charge.
                  example: 7F3CCA38-0BDA-453B-BF62-9CBD5891F77E
                reusable:
                  type: boolean
                  description: A flag to indicate the card identifier is reusable, i.e. it has been created previously.
                  default: false
        amount:
          type: object
          description: The amount charged to the customer in the smallest currency unit. (e.g 100 pence to charge £1.00, or 1 to charge ¥1 (0-decimal currency).
          $ref: '#/components/schemas/amount'
        currency:
          type: string
          maxLength: 3
          minLength: 3
          description: The currency of the amount in 3 letter [ISO 4217](https://en.wikipedia.org/wiki/ISO_4217) format.
          example: GBP





    Paypal:
      type: object
      description: The response returned by Opayo for a PayPal transaction 
      properties:
        transactionId:
          type: string
          description: Opayo's unique reference for this transaction.
          example: DB79BA2D-05DA-5B85-D188-1293D16BBAC7

        transactionType:
          type: string
          description: The type of the transaction
          enum:
            - Payment
        paymentMethod:
          type: object
          description: The `paymentMethod` object specifies the payment method for the transaction.
          properties:

            paypal:
              type: object
              description: The `paypal` object represents the PayPal details for this transaction.
              properties:
                orderId:
                  type: string
                  description: The PayPal order id.
                  example: ERT47DH1S
                payerId:
                  type: string
                  description: The PayPal payer id.
                  example: example@domain.com


        status:
          type: string
          enum:
            - Ok
            - NotAuthed
            - Rejected
            - Malformed
            - Invalid
            - Error
          description: >
            Result of transaction registration.
             * `Ok` - Transaction request completed successfully.
             * `NotAuthed` - Transaction request was not authorised by the bank.
             * `Rejected` - Transaction rejected by your fraud rules.
             * `Malformed` - Missing properties or badly formed body.
             * `Invalid` - Invalid property values supplied.
             * `Error` - An error occurred at Opayo.
        statusCode:
          type: string
          description: |
            Code related to the `status` of the transaction.
            *Successfully authorised transactions will have the `statusCode` of `0000`. You can lookup any other status code on our [website](https://www.opayo.co.uk/support/troubleshooting/error-code ).*
          example: 0000
        statusDetail:
          type: string
          description: A detailed reason for the `status` of the transaction.
          example: The Authorisation was Successful.
       
    

        amount:
          type: object
          description: The amount charged to the customer in the smallest currency unit. (e.g 100 pence to charge Â£1.00, or 1 to charge Â¥1 (0-decimal currency).
          $ref: '#/components/schemas/amount'
        currency:
          type: string
          maxLength: 3
          minLength: 3
          description: The currency of the amount in 3 letter [ISO 4217](https://en.wikipedia.org/wiki/ISO_4217) format.
          example: GBP
        shippingDetails:
          type: object
          description: The `shippingDetails` object is used to specify the shipping address details for a transaction. If not provided the values provided in the `billingAddress` object will be used for shipping information instead.
          properties:
            recipientFirstName:
              type: string
              maxLength: 20
              description: Recipient's first names.
              example: Sam
            recipientLastName:
              type: string
              maxLength: 20
              description: Recipient's last name.
              example: Jones
            shippingAddress1:
              type: string
              maxLength: 50
              description: Shipping address line 1.
              example: 407 St. John Street
            shippingAddress2:
              type: string
              maxLength: 50
              description: Shipping address line 2.
            shippingAddress3:
              type: string
              maxLength: 50
              description: Shipping address line 3.
            shippingCity:
              maxLength: 40
              type: string
              description: Shipping city.
              example: London
            shippingPostalCode:
              maxLength: 10
              type: string
              description: Shipping postal code. Not required when `shippingCountry` is `IE`.
              example: EC1V 4AB
            shippingCountry:
              type: string
              maxLength: 2
              minLength: 2
              description: Shipping country. Two letter country code defined in [ISO 3166-1](http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2)
              example: GB
            shippingState:
              type: string
              maxLength: 2
              minLength: 2
              description: Two letter state code defined in [ISO 3166-2](http://en.wikipedia.org/wiki/ISO_3166-2:US). Required when `shippingCountry` is `US`.












    3DSv2:
      type: object
      properties:
        statusCode:
          type: string
          description: |
                          Code related to the `status` of the transaction.
                          *You can lookup any status code on our [website](https://www.opayo.co.uk/support/troubleshooting/error-code).*
          example: 2021
        statusDetail:
          type: string
          description: A detailed reason for the `status` of the transaction.
          example: Please redirect your customer to the ACSURL to complete the 3DS Transaction
        transactionId:
          type: string
          description: Opayo's unique reference for this transaction.
          example: DB79BA2D-05DA-5B85-D188-1293D16BBAC7
        acsTransId:
          type: string
          description: Access Control Server (ACS) transaction ID. This is a unique ID provided by the card issuer for 3DSv2 authentications.
          example: 43b04fd1-692c-4b76-ac20-a75527ad0a25
        dsTransId:
          type: string
          description: Directory Server (DS) transaction ID. This is a unique ID provided by the card scheme for 3DSv2 authentications.
          example: 7980e36f-907b-4530-84fd-ccc1f40bf9ae
        acsUrl:
          type: string
          description: A fully qualified URL that points to the 3D Secure authentication system at the card holder's issuing bank
          example: https://url-to-be-confirmed/html_challenge
        cReq:
          type: string
          description: >
             A Base64 encoded message to be passed to the Issuing Bank as part of the 3D Secure Authentication. This replaces the PAReq. When forwarding the `cReq` to the `acsUrl`, pass it in a field called `creq` (note the lower case `cr`).  This avoids issues at the ACS which expects the fieldname to be all lowercase.

          example: eyJtZXNzYWdlVHlwZSI6IkNSZXEiLCJtZXNzYWdlVmVyc2lvbiI6IjIuMS4wIiwidGhyZWVEU1NlcnZlclRyYW5zSUQiOiIwZDUzZjA2Ni1jMDc2LTRkOGItYjcyMi04ZThhOWE0ZWE1NTIiLCJhY3NUcmFuc0lEIjoiMjdiNDlkMTgtMmE4Yi00OGIxLWE4ZTYtNzU3MzlkNmMwNDRiIiwiY2hhbGxlbmdlV2luZG93U2l6ZSI6IjAxIn0
        status:
          type: string
          example: 3DAuth


              
    cardDetails:
      type: object
      properties:
        cardholderName:
           type: string
           maxLength: 45
           description: The name of the card holder
           example: Patrick Star
        cardNumber:
          type: string
          maxLength: 16
          description: The number on the card
          example: '4929000000006'
        expiryDate:
         type: string
         maxLength: 4
         minLength: 4
         description: The expiry date of the card in `MMYY` format
         example: '0223'
        securityCode:
          type: string
          maxLength: 4
          minLength: 3
          description: The card security code, also known as CV2, CVV, or CVC. This is used in CV2 checks.
          example: '123'
      required:
        - cardholderName
        - cardNumber
        - expiryDate
        - securityCode
 


    PayPal:
      type: object
      properties:
        statusCode:
          type: string
          description: |
                          Code related to the `status` of the transaction.
                          *You can lookup any status code on our [website](https://www.opayo.co.uk/support/troubleshooting/error-code).*
             
          example: 1234
        paypal:
          type: object
          description: Contains information regarding the transaction
          properties:          
            redirectUrl:
              type: string
              maxLength: 200
              description: The PayPal URL to redirect your customer to.
              example: https://www.paypal.com
            orderId:
              type: string
              maxLength: 200
              description: The PayPal order ID.
              example: GH12345


        statusDetail:
          type: string
          description: A detailed reason for the `status` of the transaction.
          example: Please redirect your customer to the redirect URL
        transactionId:
          type: string
          description: Opayo's unique reference for this transaction.
          example: DB79BA2D-05DA-5B85-D188-1293D16BBAC7

        status:
          type: string
          example: Redirect

    ApplePaySession:
      type: object
      properties:
        transactionId:
          type: string
          description: Opayo's unique reference for this transaction.
          example: DB79BA2D-05DA-5B85-D188-1293D16BBAC7
          maxLength: 36
        status:
          type: string
          maxLength: 9
          enum:
            - Ok
            - NotAuthed
            - Rejected
            - Malformed
            - Invalid
            - Error
          description: >
            Result of transaction registration.
             * `Ok` - Transaction request completed successfully.
             * `NotAuthed` - Transaction request was not authorised by the bank.
             * `Rejected` - Transaction rejected by your fraud rules.
             * `Malformed` - Missing properties or badly formed body.
             * `Invalid` - Invalid property values supplied.
             * `Error` - An error occurred at Opayo.

 
        statusDetail:
          type: string
          description: A detailed reason for the `status` of the transaction.
          example: The Authorisation was Successful.
          maxLength: 255
        epochTimeStamp:
          type: string
          description: The date and time of the signature's creation in milliseconds, formatted in Unix epoch time.
          example: 1663928680
          maxLength: 20
        expiresAt:
          type: string
          description: The date and time of the signature's creation in milliseconds, formatted in Unix epoch time.
          example: 1663928680
          maxLength: 20
        merchantSessionIdentifier:
          type: string
          description: The value of the merchant session to be passed back to the browser session.
          maxLength: 255
        nonce:
          type: string
          description: A one-time nonce value generated by Apple's servers.
          maxLength: 255
        merchantIdentifier:
          type: string
          description: Your merchant identifier.
          maxLength: 255
        domainName:
          type: string
          description: The domain that is registered with Apple Pay.
          maxLength: 100
          example: https://www.example.com
        displayName:
          type: string
          description: The display name associated with your vendor account.
          maxLength: 50
          example: My Store
        sessionValidationToken:
          type: string
          description: A token used to validate the session when you transact via Apple Pay
          maxLength: 255
          example: SFGVHSBEVGAV/VDAYRR+345S
        signature:
          type: string
          description: A hash of the public key used to sign the interactions.
          maxLength: 255
        











